# 原创Pinpoint2.3.3监控Tongweb7049m4（by lqw）

> 原文地址: https://blog.csdn.net/weixin_39938069/article/details/141637121

---

文章目录
声明
版本说明
参考帖子
为什么不选用低版本pinpoint
端口准备
pinpoint架构说明
所需安装包
jdk版本
补丁包使用说明（这个版本的需要打补丁）
hbase1.2.6安裝
启动pinpoint-collector
访问pinpoint-web页面
Tongweb配置pinpoint-agent
声明
本帖只是演示Tongweb7049m4层面如何配置才能让Pinpoint2.3.3监控到，Pinpoint2.3.3的安装部署仅供参考,如果需要給Tongweb7049m4打补丁，请联系东方通技术人员进行支持。
版本说明
目前Tongweb7049m4自带的pinpoint版本支持如下:
高于这些版本的pinpoint需要打补丁，补丁PDMP5088（这个找技术人员要）
参考帖子
https://zhuanlan.zhihu.com/p/472331114
pinpoint2.3.3安装和部署
为什么不选用低版本pinpoint
低版本pinpoint需要使用war包形式部署pinpoint-collector.war和pinpoint-web.war（部署后里面要配很多东西，很麻烦，容易出错），需要另外安装tomcat进行部署，本次演示使用的是2.3.3的jar包，直接java -jar 启动即可，不需要再额外安装tomcat。
端口准备
部署web和controller的服务器要将防火墙对外的接口开启，9991、9992、9993、8080、8081
pinpoint架构说明
所需安装包
下图是本次示范用到的所有文件：
jdk版本
jdk1.8。
补丁包使用说明（这个版本的需要打补丁）
1.上传补丁包到服务器上。
2.打补丁前，请备份好Tongweb7049m4的安装目录。
操作参考：
1.停止tongweb服務
cd
opt/TongWeb7.0.4.9_M4_Enterprise_Linux/bin
./forcestopserver.sh
2.备份
cp
-rf
TongWeb7.0.4.9_M4_Enterprise_Linux TongWeb7.0.4.9_M4_Enterprise_Linux_bak
3.将补丁包放入到Tongweb安装目录的tools/patch-7.0/cache_dir下，执行以下指令：
[
root@localhost cache_dir
]
# cd /opt/TongWeb7.0.4.9_M4_Enterprise_Linux/tools/patch-7.0
[
root@localhost patch-7.0
]
# ./patch.sh install /opt/TongWeb7.0.4.9_M4_Enterprise_Linux  p=PDMP-5088_patch_7049.zip
有上图的提示后，执行
#home=后面用Tongweb的安装目录
./patch.sh list
home
=
/opt/TongWeb7.0.4.9_M4_Enterprise_Linux
有以下提示说明成功打上对应补丁
查看目录已有pinpoint-plugins的新版本包
hbase1.2.6安裝
解压hbase1.2.6
tar-zvxf hbase-1.2.6-bin.tar.gz
编辑hbase-env.sh文件，添加JAVA_HOME配置（该文件在hbase安装目录的conf目录下）：
# javahome
export
JAVA_HOME
=
/opt/jdk1.8.0_391
# hbase运行要用到zooker，一般单机的话，用hbase自带的就好，这里设置为true就是为了启用自带的
export
HBASE_MANAGES_ZK
=
true
同时把这两行注释了（jdk1.8已经不支持了）
备注：可通过vim方式搜索JAVA_HOME、HBASE_MANAGES_ZK、HBASE_MASTER_OPTS、HBASE_REGIONSERVER_OPTS关键字来快速定位
编辑hbase-site.xml文件（也在hbase安装目录的conf目录下）
<
configuration
>
<
property
>
<
name
>
hbase.rootdir
<
/name
>
<
value
>
file:///xxx/hbase/data
<
/value
>
<
/property
>
<
/configuration
>
配置好后，启动hbase
cd
/opt/hbase-1.2.6/bin
./start-hbase.sh
启动后可以输入jps查看
启动成功后需要初始化数据库，将hbase-create.hbase放到任意目录（例如opt），然后在hbase的bin目录执行
#opt/hbase-create.hbase是脚本的位置
./hbase shell /opt/hbase-create.hbase


这个脚本可以自己上网搜，或者自己新建一个文件，把下面的内容复制进去：

```java
create
'AgentInfo'
,
{
NAME
=
>
'Info'
, TTL
=
>
31536000
, DATA_BLOCK_ENCODING
=
>
'PREFIX'
}
create
'AgentStatV2'
,
{
NAME
=
>
'S'
, TTL
=
>
5184000
, DATA_BLOCK_ENCODING
=
>
'PREFIX'
}
,
{
SPLITS
=
>
[
"
\x01
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
"
,
"
\x02
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
"
,
"
\x03
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
"
,
"
\x04
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
"
,
"
\x05
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
"
,
"
\x06
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
"
,
"
\x07
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
"
,
"
\x08
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
"
,
"
\x09
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
"
,
"
\x0a
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
"
,
"
\x0b
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
"
,
"
\x0c
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
"
,
"
\x0d
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
"
,
"
\x0e
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
"
,
"
\x0f
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
"
,
"
\x10
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
"
,
"
\x11
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
"
,
"
\x12
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
"
,
"
\x13
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
"
,
"
\x14
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
"
,
"
\x15
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
"
,
"
\x16
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
"
,
"
\x17
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
"
,
"
\x18
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
"
,
"
\x19
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
"
,
"
\x1a
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
"
,
"
\x1b
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
"
,
"
\x1c
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
"
,
"
\x1d
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
"
,
"
\x1e
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
"
,
"
\x1f
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
"
,
"
\x20
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
"
,
"
\x21
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
"
,
"
\x22
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
"
,
"
\x23
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
"
,
"
\x24
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
"
,
"
\x25
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
"
,
"
\x26
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
"
,
"
\x27
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
"
,
"
\x28
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
"
,
"
\x29
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
"
,
"
\x2a
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
"
,
"
\x2b
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
"
,
"
\x2c
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
"
,
"
\x2d
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
"
,
"
\x2e
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
"
,
"
\x2f
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
"
,
"
\x30
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
"
,
"
\x31
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
"
,
"
\x32
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
"
,
"
\x33
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
"
,
"
\x34
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
"
,
"
\x35
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
"
,
"
\x36
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
"
,
"
\x37
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
"
,
"
\x38
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
"
,
"
\x39
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
"
,
"
\x3a
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
"
,
"
\x3b
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
"
,
"
\x3c
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
"
,
"
\x3d
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
"
,
"
\x3e
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
"
,
"
\x3f
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
"
]
}
create
'ApplicationStatAggre'
,
{
NAME
=
>
'S'
, TTL
=
>
5184000
, DATA_BLOCK_ENCODING
=
>
'PREFIX'
}
,
{
SPLITS
=
>
[
"
\x01
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
"
,
"
\x02
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
"
,
"
\x03
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
"
,
"
\x04
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
"
,
"
\x05
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
"
,
"
\x06
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
"
,
"
\x07
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
"
,
"
\x08
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
"
,
"
\x09
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
"
,
"
\x0a
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
"
,
"
\x0b
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
"
,
"
\x0c
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
"
,
"
\x0d
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
"
,
"
\x0e
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
"
,
"
\x0f
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
"
,
"
\x10
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
"
,
"
\x11
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
"
,
"
\x12
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
"
,
"
\x13
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
"
,
"
\x14
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
"
,
"
\x15
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
"
,
"
\x16
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
"
,
"
\x17
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
"
,
"
\x18
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
"
,
"
\x19
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
"
,
"
\x1a
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
"
,
"
\x1b
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
"
,
"
\x1c
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
"
,
"
\x1d
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
"
,
"
\x1e
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
"
,
"
\x1f
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
"
,
"
\x20
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
"
,
"
\x21
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
"
,
"
\x22
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
"
,
"
\x23
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
"
,
"
\x24
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
"
,
"
\x25
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
"
,
"
\x26
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
"
,
"
\x27
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
"
,
"
\x28
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
"
,
"
\x29
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
"
,
"
\x2a
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
"
,
"
\x2b
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
"
,
"
\x2c
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
"
,
"
\x2d
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
"
,
"
\x2e
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
"
,
"
\x2f
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
"
,
"
\x30
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
"
,
"
\x31
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
"
,
"
\x32
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
"
,
"
\x33
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
"
,
"
\x34
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
"
,
"
\x35
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
"
,
"
\x36
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
"
,
"
\x37
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
"
,
"
\x38
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
"
,
"
\x39
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
"
,
"
\x3a
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
"
,
"
\x3b
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
"
,
"
\x3c
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
"
,
"
\x3d
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
"
,
"
\x3e
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
"
,
"
\x3f
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
"
]
}
create
'ApplicationIndex'
,
{
NAME
=
>
'Agents'
, TTL
=
>
31536000
, DATA_BLOCK_ENCODING
=
>
'PREFIX'
}
create
'AgentLifeCycle'
,
{
NAME
=
>
'S'
, TTL
=
>
5184000
, DATA_BLOCK_ENCODING
=
>
'PREFIX'
}
create
'AgentEvent'
,
{
NAME
=
>
'E'
, TTL
=
>
5184000
, DATA_BLOCK_ENCODING
=
>
'PREFIX'
}
create
'StringMetaData'
,
{
NAME
=
>
'Str'
, TTL
=
>
15552000
, DATA_BLOCK_ENCODING
=
>
'PREFIX'
}
,
{
SPLITS
=
>
[
"
\x01
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
"
,
"
\x02
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
"
,
"
\x03
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
"
,
"
\x04
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
"
,
"
\x05
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
"
,
"
\x06
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
"
,
"
\x07
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
"
]
}
create
'ApiMetaData'
,
{
NAME
=
>
'Api'
, TTL
=
>
31536000
, DATA_BLOCK_ENCODING
=
>
'PREFIX'
}
,
{
SPLITS
=
>
[
"
\x01
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
"
,
"
\x02
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
"
,
"
\x03
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
"
,
"
\x04
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
"
,
"
\x05
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
"
,
"
\x06
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
"
,
"
\x07
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
"
]
}
create
'SqlMetaData_Ver2'
,
{
NAME
=
>
'Sql'
, TTL
=
>
15552000
, DATA_BLOCK_ENCODING
=
>
'PREFIX'
}
,
{
SPLITS
=
>
[
"
\x02
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
"
,
"
\x04
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
"
,
"
\x06
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
"
,
"
\x08
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
"
,
"
\x0a
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
"
,
"
\x0c
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
"
,
"
\x0e
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
"
,
"
\x10
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
"
,
"
\x12
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
"
,
"
\x14
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
"
,
"
\x16
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
"
,
"
\x18
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
"
,
"
\x1a
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
"
,
"
\x1c
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
"
,
"
\x1e
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
"
]
}
create
'TraceV2'
,
{
NAME
=
>
'S'
, TTL
=
>
5184000
, DATA_BLOCK_ENCODING
=
>
'PREFIX'
}
,
{
NUMREGIONS
=
>
256
, SPLITALGO
=
>
'UniformSplit'
}
create
'ApplicationTraceIndex'
,
{
NAME
=
>
'I'
, TTL
=
>
5184000
, DATA_BLOCK_ENCODING
=
>
'PREFIX'
}
,
{
SPLITS
=
>
[
"
\x02
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
"
,
"
\x04
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
"
,
"
\x06
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
"
,
"
\x08
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
"
,
"
\x0a
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
"
,
"
\x0c
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
"
,
"
\x0e
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
"
,
"
\x10
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
"
,
"
\x12
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
"
,
"
\x14
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
"
,
"
\x16
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
"
,
"
\x18
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
"
,
"
\x1a
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
"
,
"
\x1c
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
"
,
"
\x1e
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
"
]
}
create
'ApplicationMapStatisticsCaller_Ver2'
,
{
NAME
=
>
'C'
, TTL
=
>
5184000
, VERSIONS
=
>
1
, DATA_BLOCK_ENCODING
=
>
'PREFIX'
}
,
{
SPLITS
=
>
[
"
\x02
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
"
,
"
\x04
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
"
,
"
\x06
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
"
,
"
\x08
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
"
,
"
\x0a
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
"
,
"
\x0c
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
"
,
"
\x0e
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
"
,
"
\x10
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
"
,
"
\x12
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
"
,
"
\x14
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
"
,
"
\x16
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
"
,
"
\x18
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
"
,
"
\x1a
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
"
,
"
\x1c
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
"
,
"
\x1e
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
"
]
}
create
'ApplicationMapStatisticsCallee_Ver2'
,
{
NAME
=
>
'C'
, TTL
=
>
5184000
, VERSIONS
=
>
1
, DATA_BLOCK_ENCODING
=
>
'PREFIX'
}
,
{
SPLITS
=
>
[
"
\x02
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
"
,
"
\x04
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
"
,
"
\x06
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
"
,
"
\x08
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
"
,
"
\x0a
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
"
,
"
\x0c
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
"
,
"
\x0e
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
"
,
"
\x10
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
"
,
"
\x12
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
"
,
"
\x14
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
"
,
"
\x16
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
"
,
"
\x18
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
"
,
"
\x1a
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
"
,
"
\x1c
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
"
,
"
\x1e
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
"
]
}
create
'ApplicationMapStatisticsSelf_Ver2'
,
{
NAME
=
>
'C'
, TTL
=
>
5184000
, VERSIONS
=
>
1
, DATA_BLOCK_ENCODING
=
>
'PREFIX'
}
,
{
SPLITS
=
>
[
"
\x01
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
"
,
"
\x02
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
"
,
"
\x03
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
"
,
"
\x04
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
"
,
"
\x05
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
"
,
"
\x06
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
"
,
"
\x07
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
"
]
}
create
'HostApplicationMap_Ver2'
,
{
NAME
=
>
'M'
, TTL
=
>
5184000
, VERSIONS
=
>
1
, DATA_BLOCK_ENCODING
=
>
'PREFIX'
}
,
{
SPLITS
=
>
[
"
\x01
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
"
,
"
\x02
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
"
,
"
\x03
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
\x00
"
]
}
list
exit
如下图说明初始化成功
访问服务器ip：16010
访问服务器ip:16010/tablesDetailed.jsp
启动pinpoint-collector
将pinpoint-collector-boot-2.3.3.jar放在任意目录，执行以下指令启动：
nohup
java
-jar
-Dpinpoint.zookeeper.address
=
127.0
.0.1 pinpoint-collector-boot-2.3.3.jar
>
console_ppc.log
2
>
&1
&
这里由于hbase用的是自嵌入zooker，且habse跟pinpoint-collector在同一台服务器，所以配的127.0.0.1。
启动后可以用jps查看进程：
ps
-ef
|
grep
pinpoint
如果要查看日志，一般在同一級目录会生成一个logs目录，里面就是日志文件：
访问pinpoint-web页面
将pinpoint-web-boot-2.3.3.jar放在任意目录，执行以下指令启动：
nohup
java
-jar
-Dpinpoint.zookeeper.address
=
127.0
.0.1 pinpoint-web-boot-2.3.3.jar
>
console_ppc.log
2
>
&1
&
这里由于hbase用的是自嵌入zooker，且habse跟pinpoint-collector在同一台服务器，所以配的127.0.0.1。
启动后可以用jps查看进程：
ps
-ef
|
grep
pinpoint
如果要查看日志，一般在同一級目录会生成一个logs目录，里面就是日志文件：
可以访问服务器ip:8080/测试是否运行成功。
Tongweb配置pinpoint-agent
pinpoint最終是通過agent来跟Tongweb交互的，所以我们需要做好相关配置。
首先找个目录，解压pinpoint-agent
tar
-zvxf
pinpoint-agent-2.3.3.tar.gz
解压完后，到Tongweb7049m4的tools下的目录找一下对应版本的pointplugins里的jar包，如下图所示：
將這個jar包cp到pinpoint-agent-2.3.3的plugin下：
弄好后找一找这个包的路径(pinpoint-bootstrap-xxxx.jar,一般就在agent的安装目录下)：
找一找/opt/pinpoint-agent-2.3.3/profiles目录，在这个目录下的local或者release目录下找到 pinpoint.config，配置如下信息：
profiler.tongweb.enable
=
true
profiler.tongweb.bootstrap.main
=
com.tongweb.main.TongWebMain
profiler.tongweb.hidepinpointheader
=
true
profiler.tongweb.excludeurl
=
profiler.tongweb.tracerequestparam
=
true
关闭Tongweb，备份好Tongweb目录
cp
-rf
/opt/TongWeb7.0.4.9_M4_Enterprise_Linux /opt/TongWeb7.0.4.9_M4_Enterprise_Linux
然后找到bin目录下的external.vmoptions，配置以下内容：
-javaagent:/opt/pinpoint-agent-2.3.3/pinpoint-bootstrap-2.3.3.jar
-Dpinpoint.agentId
=
1000001
-Dpinpoint.applicationName
=
tongweb_test
备注：
1.配置的时候不要用#，不要添加任何符号，会启动报错的
2./opt/pinpoint-agent-2.3.3/pinpoint-bootstrap-2.3.3.jar是pinpoint-bootstrap-2.3.3.jar的路径
3.tongweb_test是我自己配的，可根据自身需求配其他的name都可以。
配置后启动Tongweb，访问服务器ip:8080/，如下图所示，能刷出applicationName（本次配的是tongweb_test）,说明识别到了。