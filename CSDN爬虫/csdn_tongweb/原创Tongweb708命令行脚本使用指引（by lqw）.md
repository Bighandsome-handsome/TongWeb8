# 原创Tongweb708命令行脚本使用指引（by lqw）

> 原文地址: https://blog.csdn.net/weixin_39938069/article/details/152028228

---

文章目录
声明
通过comm脚本修改用户密码
关于密码加密和passwordfile
通过comm脚本创建用户并赋予角色
关于实例，节点和集群
实例的概念
节点的概念
集群的概念
操作思路
命令行操作实例
新建实例
启动实例
停止实例
删除实例
实例部署应用
实例查看应用列表和配置
实例停止应用
实例启动应用
实例备份应用
实例自定义备份数
默认实例查看应用备份
默认实例删除应用备份
默认实例从应用备份恢复应用
默认实例卸载应用
命令行操作节点
查看节点列表
手动安装的节点进行自动注册
停止手动安装的节点
启动手动安装的节点
删除手动安装的节点
命令行操作集群
创建集群
启动集群
查看集群
集群部署应用
集群启动应用
集群查看应用
集群停止应用
集群删除应用
删除集群
声明
本帖参考Tongweb708命令行手册+控制台脚本录制功能编写，仅供参考，不代表其他版本的tongweb也能用同样的方式，具体以产品对应版本的产品手册为准。
通过comm脚本修改用户密码
./commandstool.sh
--model
=
password
--action
=
update
\
--username
=
thanos
\
--password
=
"Yeyehuo163.com"
\
--host
=
192.168
.10.123
\
--port
=
9060
\
--acceptAgreement
=
true
\
originalPassword
=
"Yeyehuo163.com"
\
newPassword
=
"Yeyehuo164.com"
\
confirmPassword
=
"Yeyehuo164.com"
关于密码加密和passwordfile
正常的comm脚本使用，是要在执行的时候，指定用户名和密码的，例如：
有时我们可能不止一个人使用，并且不想暴露密码给别人，也不想手敲加密的密文那么麻烦，这个时候，可以使用加密工具和passwordfile。
#进入到安装目录的bin
cd
/opt/TongWeb7.0.8.905/bin
[
root@localhost bin
]
# ./admin.sh encrypt id "Yeyehuo164.com"
2025
-09-24
13
:16:50
>>
>
[
domain1
]
id: Tw80EncodedPrefixFlagLFSXSZLIOVXTCNRUFZRW63I
#也可以用comm脚本
./commandstool.sh
\
--host
=
192.168
.10.123
\
--port
=
9060
\
--model
=
encryptor
\
--action
=
update
\
--username
=
thanos
\
--password
=
'Yeyehuo164.com'
\
--acceptAgreement
=
true
\
input
=
'Yeyehuo164.com'
\
encryptMethod
=
id
\
digestAlg
=
SHA-256
\
saltLength
=
1
\
iterations
=
1
备注：
1.加密后的密文并不是每次都一样的，这个不妨碍使用。
加密后，自己建一个passwordfile.txt，在里面填写以下内容：
thanos
=
Tw80EncodedPrefixFlagLFSXSZLIOVXTCNRUFZRW63I
# 加密后的密码
这样，当我们执行comm脚本的时候，就可以使用–passwordfile=/opt/passwordfile.txt这种形式
备注：
1.如果有使用控制台的话，一般不建议用thanos这个账号，最好自己单独建一个账号。
2.passwordfile的属主必须和comm脚本的属主一致。
3.示范使用的是在线模式，需要保证tongweb正常运行。
通过comm脚本创建用户并赋予角色
先用thanos用户创建用户
./commandstool.sh
\
--host
=
192.168
.10.123
\
--port
=
9060
\
--model
=
user
\
--action
=
add
\
--username
=
thanos
\
--passwordfile
=
/opt/TongWeb7.0.8.905/passwordfile.txt
\
--acceptAgreement
=
true
\
name
=
yehuo
\
password
=
'Yeyehuo163.com'
\
confirmPassword
=
'Yeyehuo163.com'
\
digestAlg
=
SHA-256
\
active
=
true
\
info
=
'系统管理员'
\
changeInitPwd
=
false
\
minLen
=
8
\
saltLength
=
4
\
iterations
=
5
\
limitRepeats
=
5
\
passwordMinAge
=
0
\
passwordMaxAge
=
90
\
composition
=
'Tw80EncodedPrefixFlagJZ2W2YTFOIWEG2DBOIWEGYLTMUWFG4DFMNUWC3BMJZXUG33OONSWG5LUNF3GKLCON5KXGZLS'
备注：
1.建议除了用户名，密码之外，其他的参数用示范的，否则需要参考命令行手册和脚本录制自行调整。
然后通过security用户配置角色（例如自带的system），下面是自带角色的介绍：
使用加密工具，加密security的密码（用摘要算法digest）：
#Yeyehuo164.com为要加密的明文
[
root@localhost bin
]
# ./admin.sh encrypt asymmetric "Yeyehuo164.com"
2025
-09-24
16
:21:24
>>
>
[
domain1
]
asymmetric: 150D5EBFED77F17D88C9A638AB18C4F1FD72BA4A8CDB7F9DB7B728142AA1918AD7FD15E162803A7427EE3EC7D217F2E4EE9F16EE3B76E9FFD8F31C0F130DC99411160F9E0D06FFD1FDB1AD4ABAC64C08F544962377DE177EA01B18F99835448828F0E325F3D03E651059DAFE5F79824B2392278E7334B82657C3ED478ABB4099
#还可以通过脚本输出加密密文
./commandstool.sh
\
--host
=
192.168
.10.123
\
--port
=
9060
\
--model
=
encryptor
\
--action
=
update
\
--username
=
thanos
\
--passwordfie
=
'Yeyehuo164.com'
\
--acceptAgreement
=
true
\
input
=
'Yeyehuo164.com'
\
encryptMethod
=
asymmetric
新建security_password.txt，内容如下：
#格式：用户名=加密的密文
security
=
150D5EBFED77F17D88C9A638AB18C4F1FD72BA4A8CDB7F9DB7B728142AA1918AD7FD15E162803A7427EE3EC7D217F2E4EE9F16EE3B76E9FFD8F31C0F130DC99411160F9E0D06FFD1FDB1AD4ABAC64C08F544962377DE177EA01B18F99835448828F0E325F3D03E651059DAFE5F79824B2392278E7334B82657C3ED478ABB4099
执行以下指令，将对应的角色赋权给新建的角色：
[
root@localhost bin
]
# ./commandstool.sh     --host=192.168.10.123     --port=9060     --model=userrole     --action=update     --username=security     --passwordfile=/opt/TongWeb7.0.8.905/security_password.txt     --acceptAgreement=true     name=yeyehuo nodes=default     roles=system
{
"models"
:
[
]
,
"attachments"
:
{
}
,
"success"
:
"true"
,
"msg"
:
"权限分配更新成功"
,
"redirectURL"
:
""
,
"dataTime"
:
""
}
参数说明：
备注：
同理：
#进入到安装目录的bin
cd
/opt/TongWeb7.0.8.905/bin
[
root@localhost bin
]
# ./admin.sh encrypt id "Yeyehuo163.com"
2025
-09-24
13
:16:50
>>
>
[
domain1
]
id: Tw80EncodedPrefixFlagLFSXSZLIOVXTCNRTFZRW63I
跟上述一样，自己弄个passwordfile.txt（txt的名字随意，只要是自己能认出来是密码文件即可），把账号密码放进去：
#用户名=密文密码
yehuo
=
Tw80EncodedPrefixFlagLFSXSZLIOVXTCNRTFZRW63I
关于实例，节点和集群
实例的概念
备注：
1.tongweb新装的时候，默认是有自带的实例的，就叫domain1，在安装目录的domains目录可以找到对应的目录。
2.一般情况下，如果用到集群，不建议用默认的domain1部署应用。
节点的概念
备注：
1.可以理解为，一台服务器只能有一个节点。
集群的概念
操作思路
一般情况下，如果是已经建立了集群的，建议从集群的层面来操作（例如部署应用），其次是节点，最后才是实例。
不要通过命令行操作了集群部署了应用，然后自己又用命令行单独改某个节点上的应用，这种很容易出问题。
命令行操作实例
新建实例
前提：
1.需有节点在运行。
2.可以加个name=实例名来命令新实例，如果没有的话，也会自动生成。
使用以下指令查看节点列表：
./commandstool.sh
\
--model
=
node
\
--action
=
list
\
--username
=
thanos
\
--passwordfile
=
/opt/TongWeb7.0.8.905/passwordfile.txt
\
--acceptAgreement
=
true
./commandstool.sh
\
--host
=
192.168
.10.123
\
--port
=
9060
\
--model
=
instance
\
--action
=
add
\
--username
=
thanos
\
--passwordfile
=
/opt/TongWeb7.0.8.905/passwordfile.txt
\
--acceptAgreement
=
true
\
name
=
"clustertest01-c3c80bbfdd2a4a6d94471f3b8f46a356-1"
node
=
"6bb3f88ce6e0473180dbbe0511af3c27"
启动实例
./commandstool.sh
\
--host
=
192.168
.10.123
\
--port
=
9060
\
--model
=
instance
\
--action
=
start
\
--username
=
thanos
\
--passwordfile
=
/opt/TongWeb7.0.8.905/passwordfile.txt
\
--acceptAgreement
=
true
\
name
=
"clustertest01-c3c80bbfdd2a4a6d94471f3b8f46a356-1"
停止实例
./commandstool.sh
\
--host
=
192.168
.10.123
\
--port
=
9060
\
--model
=
instance
\
--action
=
stop
\
--username
=
thanos
\
--passwordfile
=
/opt/TongWeb7.0.8.905/passwordfile.txt
\
--acceptAgreement
=
true
\
name
=
"clustertest01-c3c80bbfdd2a4a6d94471f3b8f46a356-1"
删除实例
./commandstool.sh
\
--host
=
192.168
.10.123
\
--port
=
9060
\
--model
=
instance
\
--action
=
delete
\
--username
=
thanos
\
--passwordfile
=
/opt/TongWeb7.0.8.905/passwordfile.txt
\
--acceptAgreement
=
true
\
name
=
"clustertest01-c3c80bbfdd2a4a6d94471f3b8f46a356-1"
!
[
在这里插入图片描述
]
(
https://i-blog.csdnimg.cn/direct/36e245f599ad4983afbb882a2eaaaac1.png
)
实例部署应用
一般如果是单机的情况下，可以考虑使用默认实例部署应用。
./commandstool.sh
--model
=
app
--action
=
add
\
--host
=
192.168
.10.123
\
--port
=
9060
\
--username
=
thanos
\
--acceptAgreement
=
true
\
--passwordfile
=
/opt/TongWeb7.0.8.905/passwordfile.txt
\
appFrom
=
fromServer
\
filename
=
/opt/TongWeb7.0.8.905/version7.0.8.905/examples/examples.war
\
contextRoot
=
/webserver
\
autoDeploy
=
false
\
targetType
=
instance
targetName
=
domain1
部署后，看到以下提示，说明部署成功：
实例查看应用列表和配置
./commandstool.sh
--model
=
app
--action
=
list
\
--host
=
192.168
.10.123
\
--port
=
9060
\
--username
=
thanos
\
--acceptAgreement
=
true
\
--passwordfile
=
/opt/TongWeb7.0.8.905/passwordfile.txt
\
targetType
=
instance
targetName
=
domain1
一般会返回以下信息：
{
"models"
:
[
{
"name"
:
"example"
,
"autoDeploy"
:
"false"
,
"appFrom"
:
"fromServer"
,
"filename"
:
"deployment\/examples"
,
"unpackDir"
:
"deployment"
,
"appTemplate"
:
""
,
"springBootCompatible"
:
"false"
,
"contextRoot"
:
"examples"
,
"host"
:
"localhost"
,
"startupPriority"
:
"99"
,
"refRealm"
:
""
,
"dependentApp"
:
""
,
"delegateFirst"
:
"false"
,
"useEjbStandaloneLoader"
:
"false"
,
"forcedLoad"
:
"javax.ws.rs."
,
"forcedSkip"
:
""
,
"webSocketEnabled"
:
"false"
,
"webModuleOnly"
:
"false"
,
"appImplModules"
:
""
,
"refLib"
:
""
,
"priorityJars"
:
""
,
"reloadable"
:
"false"
,
"addWebinfClassesResources"
:
"false"
,
"loadManifestClassPath"
:
"false"
,
"manifestClassPathBase"
:
""
,
"absoluteOrdering"
:
"false"
,
"showLoadedClasses"
:
"false"
,
"customClassLoader"
:
""
,
"customClass"
:
""
,
"docBases"
:
""
,
"archiveIndexStrategy"
:
"SIMPLE"
,
"sessionCookieName"
:
""
,
"useLegacyCookieProcessor"
:
"false"
,
"allowEqualsInValue"
:
"false"
,
"allowHttpSepsInV0"
:
"false"
,
"useHttpOnly"
:
"true"
,
"sameSiteCookies"
:
"Unset"
,
"maxActiveSessions"
:
"100000"
,
"sessionTimeout"
:
"30"
,
"refSessionHa"
:
""
,
"jspDevelopment"
:
"false"
,
"mappedFile"
:
"false"
,
"quoteAttributeEL"
:
"true"
,
"strictQuoteEscaping"
:
"true"
,
"strictWhiteSpace"
:
"true"
,
"enablePooling"
:
"true"
,
"jspPrecompile"
:
"false"
,
"jspPrecompileThreadCount"
:
"4"
,
"requestCharacterEncoding"
:
"UTF-8"
,
"responseCharacterEncoding"
:
"UTF-8"
,
"javaEncoding"
:
"UTF-8"
,
"fileEncoding"
:
"UTF-8"
,
"slowThreadEnabled"
:
"false"
,
"threshold"
:
"1000"
,
"interruptThreadThreshold"
:
"0"
,
"cachingAllowed"
:
"true"
,
"cacheMaxSize"
:
"102400"
,
"cacheObjectMaxSize"
:
"1024"
,
"cacheTtl"
:
"60"
,
"forceCache"
:
"false"
,
"expiresFilterEnabled"
:
"false"
,
"expiresFilterInitParam"
:
""
,
"expiresFilterUrlPatterns"
:
""
,
"preloadResource"
:
"false"
,
"preCompress"
:
"false"
,
"brEnabled"
:
"false"
,
"forcedContainerHandling"
:
"false"
,
"staticUrlPatterns"
:
""
,
"enableCORSAccess"
:
"false"
,
"corsAllowedOrigins"
:
""
,
"corsAllowedMethods"
:
"GET,POST,HEAD,OPTIONS"
,
"corsAllowedHeaders"
:
"Origin,Accept,X-Requested-With,Content-Type,Access-Control-Request-Method,Access-Control-Request-Headers"
,
"corsExposedHeaders"
:
""
,
"corsSupportCredentials"
:
"false"
,
"corsPreflightMaxAge"
:
"1800"
,
"requestParametersLostValidation"
:
"false"
,
"XSSFilterEnabled"
:
"false"
,
"csrfPrevention"
:
"false"
,
"csrfCacheSize"
:
"20"
,
"tokenValidTimes"
:
"1"
,
"csrfEntryPoints"
:
"\/login"
,
"httpHeaderToken"
:
"false"
,
"secretLevel"
:
""
,
"threadPoolPolicy"
:
"1"
,
"threadPool"
:
""
,
"threadPoolTimeout"
:
"30000"
,
"taskRule"
:
""
,
"exclusionRule"
:
""
,
"otherThreadPool"
:
""
,
"otherThreadPoolTimeout"
:
"30000"
,
"semaphoreEnabled"
:
"false"
,
"concurrency"
:
"10"
,
"block"
:
"true"
,
"interruptible"
:
"true"
,
"restrictedPorts"
:
""
,
"crossContext"
:
"false"
,
"unloadDelay"
:
"20"
,
"allowLinking"
:
"false"
,
"clearReferences"
:
"false"
,
"enableRecycling"
:
"true"
,
"shtmlEnabled"
:
"false"
,
"virtualWebappRelative"
:
"false"
,
"allowExec"
:
"false"
,
"expires"
:
"0"
,
"urlPatterns"
:
"*.shtml"
,
"webAppVersion"
:
""
,
"useRelativeRedirects"
:
"true"
,
"forceUseRelativeRedirects"
:
"false"
,
"allowCasualMultipartParsing"
:
"false"
,
"allowOverrideContentType"
:
"true"
,
"enableStatelessPoolMonitor"
:
"false"
,
"type"
:
"war"
,
"state"
:
"STARTED"
,
"jarScannerImpl"
:
""
,
"useDirectionalScanning"
:
"false"
,
"servletAnnotationDeclarationFile"
:
""
,
"applicationPropertiesFile"
:
""
,
"raPros"
:
""
,
"pkgCompatible"
:
"false"
,
"addResponseHeader"
:
""
}
,
{
"name"
:
"examples"
,
"autoDeploy"
:
"false"
,
"appFrom"
:
"fromServer"
,
"filename"
:
"deployment\/examples"
,
"unpackDir"
:
"deployment"
,
"appTemplate"
:
""
,
"springBootCompatible"
:
"false"
,
"contextRoot"
:
"webserver"
,
"host"
:
"localhost"
,
"startupPriority"
:
"99"
,
"refRealm"
:
""
,
"dependentApp"
:
""
,
"delegateFirst"
:
"false"
,
"useEjbStandaloneLoader"
:
"false"
,
"forcedLoad"
:
"javax.ws.rs."
,
"forcedSkip"
:
""
,
"webSocketEnabled"
:
"false"
,
"webModuleOnly"
:
"false"
,
"appImplModules"
:
""
,
"refLib"
:
""
,
"priorityJars"
:
""
,
"reloadable"
:
"false"
,
"addWebinfClassesResources"
:
"false"
,
"loadManifestClassPath"
:
"false"
,
"manifestClassPathBase"
:
""
,
"absoluteOrdering"
:
"false"
,
"showLoadedClasses"
:
"false"
,
"customClassLoader"
:
""
,
"customClass"
:
""
,
"docBases"
:
""
,
"archiveIndexStrategy"
:
"SIMPLE"
,
"sessionCookieName"
:
""
,
"useLegacyCookieProcessor"
:
"false"
,
"allowEqualsInValue"
:
"false"
,
"allowHttpSepsInV0"
:
"false"
,
"useHttpOnly"
:
"true"
,
"sameSiteCookies"
:
"Unset"
,
"maxActiveSessions"
:
"100000"
,
"sessionTimeout"
:
"30"
,
"refSessionHa"
:
""
,
"jspDevelopment"
:
"false"
,
"mappedFile"
:
"false"
,
"quoteAttributeEL"
:
"true"
,
"strictQuoteEscaping"
:
"true"
,
"strictWhiteSpace"
:
"true"
,
"enablePooling"
:
"true"
,
"jspPrecompile"
:
"false"
,
"jspPrecompileThreadCount"
:
"4"
,
"requestCharacterEncoding"
:
"UTF-8"
,
"responseCharacterEncoding"
:
"UTF-8"
,
"javaEncoding"
:
"UTF-8"
,
"fileEncoding"
:
"UTF-8"
,
"slowThreadEnabled"
:
"false"
,
"threshold"
:
"1000"
,
"interruptThreadThreshold"
:
"0"
,
"cachingAllowed"
:
"true"
,
"cacheMaxSize"
:
"102400"
,
"cacheObjectMaxSize"
:
"1024"
,
"cacheTtl"
:
"60"
,
"forceCache"
:
"false"
,
"expiresFilterEnabled"
:
"false"
,
"expiresFilterInitParam"
:
""
,
"expiresFilterUrlPatterns"
:
""
,
"preloadResource"
:
"false"
,
"preCompress"
:
"false"
,
"brEnabled"
:
"false"
,
"forcedContainerHandling"
:
"false"
,
"staticUrlPatterns"
:
""
,
"enableCORSAccess"
:
"false"
,
"corsAllowedOrigins"
:
""
,
"corsAllowedMethods"
:
"GET,POST,HEAD,OPTIONS"
,
"corsAllowedHeaders"
:
"Origin,Accept,X-Requested-With,Content-Type,Access-Control-Request-Method,Access-Control-Request-Headers"
,
"corsExposedHeaders"
:
""
,
"corsSupportCredentials"
:
"false"
,
"corsPreflightMaxAge"
:
"1800"
,
"requestParametersLostValidation"
:
"false"
,
"XSSFilterEnabled"
:
"false"
,
"csrfPrevention"
:
"false"
,
"csrfCacheSize"
:
"20"
,
"tokenValidTimes"
:
"1"
,
"csrfEntryPoints"
:
"\/login"
,
"httpHeaderToken"
:
"false"
,
"secretLevel"
:
""
,
"threadPoolPolicy"
:
"1"
,
"threadPool"
:
""
,
"threadPoolTimeout"
:
"30000"
,
"taskRule"
:
""
,
"exclusionRule"
:
""
,
"otherThreadPool"
:
""
,
"otherThreadPoolTimeout"
:
"30000"
,
"semaphoreEnabled"
:
"false"
,
"concurrency"
:
"10"
,
"block"
:
"true"
,
"interruptible"
:
"true"
,
"restrictedPorts"
:
""
,
"crossContext"
:
"false"
,
"unloadDelay"
:
"20"
,
"allowLinking"
:
"false"
,
"clearReferences"
:
"false"
,
"enableRecycling"
:
"true"
,
"shtmlEnabled"
:
"false"
,
"virtualWebappRelative"
:
"false"
,
"allowExec"
:
"false"
,
"expires"
:
"0"
,
"urlPatterns"
:
"*.shtml"
,
"webAppVersion"
:
""
,
"useRelativeRedirects"
:
"true"
,
"forceUseRelativeRedirects"
:
"false"
,
"allowCasualMultipartParsing"
:
"false"
,
"allowOverrideContentType"
:
"true"
,
"enableStatelessPoolMonitor"
:
"false"
,
"type"
:
"war"
,
"state"
:
"STARTED"
,
"jarScannerImpl"
:
""
,
"useDirectionalScanning"
:
"false"
,
"servletAnnotationDeclarationFile"
:
""
,
"applicationPropertiesFile"
:
""
,
"raPros"
:
""
,
"pkgCompatible"
:
"false"
,
"addResponseHeader"
:
""
}
]
,
"attachments"
:
{
"totalSize"
:
"2"
,
"pageNum"
:
"1"
,
"pageSize"
:
"10"
}
,
"success"
:
"true"
,
"msg"
:
"应用列表成功"
,
"redirectURL"
:
""
,
"dataTime"
:
""
}
可通过该指令，确认应用上的一些配置。
如果知道应用名称，还可以这样查看
./commandstool.sh
\
--host
=
192.168
.10.123
\
--port
=
9060
\
--model
=
app
\
--action
=
show
\
--username
=
thanos
\
--passwordfile
=
/opt/TongWeb7.0.8.905/passwordfile.txt
\
--acceptAgreement
=
true
\
targetType
=
instance
\
targetName
=
domain1
\
name
=
example
实例停止应用
./commandstool.sh
\
--host
=
192.168
.10.123
\
--port
=
9060
\
--model
=
app
\
--action
=
stop
\
--username
=
thanos
\
--passwordfile
=
/opt/TongWeb7.0.8.905/passwordfile.txt
\
--acceptAgreement
=
true
\
targetType
=
instance
\
targetName
=
domain1
\
name
=
examples
实例启动应用
./commandstool.sh
\
--host
=
192.168
.10.123
\
--port
=
9060
\
--model
=
app
\
--action
=
start
\
--username
=
thanos
\
--passwordfile
=
/opt/TongWeb7.0.8.905/passwordfile.txt
\
--acceptAgreement
=
true
\
targetType
=
instance
\
targetName
=
domain1
\
name
=
examples
实例备份应用
./commandstool.sh
\
--host
=
192.168
.10.123
\
--port
=
9060
\
--model
=
appbackup
\
--action
=
add
\
--username
=
thanos
\
--passwordfile
=
/opt/TongWeb7.0.8.905/passwordfile.txt
\
--acceptAgreement
=
true
\
targetType
=
instance
\
targetName
=
domain1
\
app
=
examples
\
backupInfo
=
"日常备份-
$(
date
+%Y%m%d
)
"
执行成功后，可到对应目录（domains/domain1/data/app/backup里查看）
实例自定义备份数
./commandstool.sh
\
--host
=
192.168
.10.123
\
--port
=
9060
\
--model
=
server
\
--action
=
update
\
--username
=
thanos
\
--passwordfile
=
/opt/TongWeb7.0.8.905/passwordfile.txt
\
--acceptAgreement
=
true
\
targetType
=
instance
\
targetName
=
domain1
\
appBackupCount
=
5
默认实例查看应用备份
./commandstool.sh
\
--host
=
192.168
.10.123
\
--port
=
9060
\
--model
=
appbackup
\
--action
=
list
\
--username
=
thanos
\
--passwordfile
=
/opt/TongWeb7.0.8.905/passwordfile.txt
\
--acceptAgreement
=
true
\
targetType
=
instance
\
targetName
=
domain1
默认实例删除应用备份
前提：
1.需要确认删除的应用备份的名称。
可通过以下指令确认：
./commandstool.sh
\
--host
=
192.168
.10.123
\
--port
=
9060
\
--model
=
appbackup
\
--action
=
list
\
--username
=
thanos
\
--passwordfile
=
/opt/TongWeb7.0.8.905/passwordfile.txt
\
--acceptAgreement
=
true
\
targetType
=
instance
\
targetName
=
domain1
确认后执行以下指令：
./commandstool.sh
\
--host
=
192.168
.10.123
\
--port
=
9060
\
--model
=
appbackup
\
--action
=
delete
\
--username
=
thanos
\
--passwordfile
=
/opt/TongWeb7.0.8.905/passwordfile.txt
\
--acceptAgreement
=
true
\
targetType
=
instance
\
targetName
=
domain1
\
name
=
examples.BackupFlag20230925111529
默认实例从应用备份恢复应用
需要先确认备份的名称，具体参考之前的章节
./commandstool.sh
\
>
--host
=
192.168
.10.123
\
>
--port
=
9060
\
>
--model
=
appbackup
\
>
--action
=
recover
\
>
--username
=
thanos
\
>
--passwordfile
=
/opt/TongWeb7.0.8.905/passwordfile.txt
\
>
--acceptAgreement
=
true
\
>
targetType
=
instance
\
>
targetName
=
domain1
\
>
name
=
examples.BackupFlag20250925113212
默认实例卸载应用
建议做好了备份再卸载。
./commandstool.sh
\
--host
=
192.168
.10.123
\
--port
=
9060
\
--model
=
app
\
--action
=
delete
\
--username
=
thanos
\
--passwordfile
=
/opt/TongWeb7.0.8.905/passwordfile.txt
\
--acceptAgreement
=
true
\
targetType
=
instance
\
targetName
=
domain1
\
name
=
examples
命令行操作节点
查看节点列表
./commandstool.sh
\
--host
=
192.168
.10.123
\
--port
=
9060
\
--model
=
node
\
--action
=
list
\
--username
=
thanos
\
--passwordfile
=
/opt/TongWeb7.0.8.905/passwordfile.txt
\
--acceptAgreement
=
true
\
--outputType
=
table
手动安装的节点进行自动注册
假设a跟b已经安装好了tongweb（可参考以下网页链接：https://blog.csdn.net/weixin_39938069/article/details/152000422?spm=1011.2415.3001.5331），安装路径一致，其中a是123，b是111,b需要a进行纳管。
那么需要先开启a的集中管理功能（可通过控制台开启）。
也可以用comm脚本开启：
./commandstool.sh
--host
=
192.168
.10.123
--port
=
9060
--model
=
server
--action
=
update
--username
=
thanos
--passwordfile
=
/opt/TongWeb7.0.8.905/passwordfile.txt
--acceptAgreement
=
true
remoteSupported
=
true
autoRegister
=
true
registerAsNode
=
true
autoClusterId
=
test3
centralizedConsoleUrl
=
"https://192.168.10.123:9060/console"
开启后，同理，b也需要开启集中管理功能。
留意一下，b在开启的时候，centralizedConsoleUrl就要填写a的，也就是https://192.168.10.123:9060/console。
开启后，建议用centralizedConsoleUrl对应的tongweb下执行脚本查看节点列表：
./commandstool.sh
\
--host
=
192.168
.10.123
\
--port
=
9060
\
--model
=
node
\
--action
=
list
\
--username
=
thanos
\
--passwordfile
=
/opt/TongWeb7.0.8.905/passwordfile.txt
\
--acceptAgreement
=
true
\
--outputType
=
table
也可以在centralizedConsoleUrl对应的控制台查看，一般只要执行命令里同意了开启自动注册，就会注册进去：
停止手动安装的节点
命令行脚本只支持通过ssh安装的节点，如果是非ssh形式安装，只能手动停止对应节点。
cd 到安装目录的bin目录，执行停止脚本stopserver.sh 或者强停脚本forcestop.sh。
启动手动安装的节点
命令行脚本只支持通过ssh安装的节点，如果是非ssh形式安装，只能手动停止对应节点。
cd 到安装目录的bin目录，执行启动脚本stard.sh。
删除手动安装的节点
手动停止节点后rm -rf删除该节点的安装目录即可。
命令行操作集群
创建集群
前提：
1.节点没有加入到集群
2.需确认节点名称
./commandstool.sh
\
--host
=
192.168
.10.123
\
--port
=
9060
\
--model
=
cluster
\
--action
=
add
\
--username
=
thanos
\
--passwordfile
=
/opt/TongWeb7.0.8.905/passwordfile.txt
\
--acceptAgreement
=
true
\
name
=
clustertest01
\
node
=
6bb3f88ce6e0473180dbbe0511af3c27,c3c80bbfdd2a4a6d94471f3b8f46a356
\
startwithnode
=
false
\
maxretrycount
=
0
\
autostart
=
false
\
rollingUpdate
=
false
启动集群
./commandstool.sh
\
--host
=
192.168
.10.123
\
--port
=
9060
\
--model
=
cluster
\
--action
=
start
\
--username
=
thanos
\
--passwordfile
=
/opt/TongWeb7.0.8.905/passwordfile.txt
\
--acceptAgreement
=
true
\
name
=
clustertest01
查看集群
./commandstool.sh
\
--host
=
192.168
.10.123
\
--port
=
9060
\
--model
=
cluster
\
--action
=
show
\
--username
=
thanos
\
--passwordfile
=
/opt/TongWeb7.0.8.905/passwordfile.txt
\
--acceptAgreement
=
true
\
name
=
clustertest01
集群部署应用
前提：
部署的应用包必须都在同一个目录下。
./commandstool.sh
--model
=
app
--action
=
add
\
--host
=
192.168
.10.123
\
--port
=
9060
\
--username
=
thanos
\
--acceptAgreement
=
true
\
--passwordfile
=
/opt/TongWeb7.0.8.905/passwordfile.txt
\
appFrom
=
fromServer
\
filename
=
/opt/examples.war
\
contextRoot
=
/webserver
\
autoDeploy
=
false
\
targetType
=
cluster
targetName
=
clustertest01
集群启动应用
./commandstool.sh
\
--host
=
192.168
.10.123
\
--port
=
9060
\
--model
=
app
\
--action
=
start
\
--username
=
thanos
\
--passwordfile
=
/opt/TongWeb7.0.8.905/passwordfile.txt
\
--acceptAgreement
=
true
\
targetType
=
cluster
\
targetName
=
clustertest01
name
=
examples
集群查看应用
./commandstool.sh
--host
=
192.168
.10.123
--port
=
9060
--model
=
app
--action
=
list
--username
=
thanos
--passwordfile
=
/opt/TongWeb7.0.8.905/passwordfile.txt
--acceptAgreement
=
true
targetType
=
cluster
targetName
=
clustertest01
name
=
examples
集群停止应用
./commandstool.sh
\
--host
=
192.168
.10.123
\
--port
=
9060
\
--model
=
app
\
--action
=
stop
\
--username
=
thanos
\
--passwordfile
=
/opt/TongWeb7.0.8.905/passwordfile.txt
\
--acceptAgreement
=
true
\
targetType
=
cluster
\
targetName
=
clustertest01
name
=
examples
集群删除应用
./commandstool.sh
\
--host
=
192.168
.10.123
\
--port
=
9060
\
--model
=
app
\
--action
=
delete
\
--username
=
thanos
\
--passwordfile
=
/opt/TongWeb7.0.8.905/passwordfile.txt
\
--acceptAgreement
=
true
\
targetType
=
cluster
\
targetName
=
clustertest01
name
=
examples
删除集群
./commandstool.sh
\
--host
=
192.168
.10.123
\
--port
=
9060
\
--model
=
cluster
\
--action
=
delete
\
--username
=
thanos
\
--passwordfile
=
/opt/TongWeb7.0.8.905/passwordfile.txt
\
--acceptAgreement
=
true
\
name
=
clustertest01
备注：
1.如有提示，请根据提示处理
例如下图，提示是集群正在被实例占用，并提供了实例名，这个时候可以先停止和卸载了对应的实例，再操作即可。