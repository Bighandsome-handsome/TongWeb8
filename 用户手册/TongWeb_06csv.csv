Question,Answer
1 技术指标类 -> 1.1 支持 JDK 版本是什么？,"JDK8-JDK24。 
• 支持 Oracle JDK，但部分 Oracle JDK 版本商用收费，在生产使用时请注意商业授权，或采用 OpenJDK、Tong JDK。
• 启用国密认证，JDK 要求 JDK8-JDK11。
• 使用虚拟线程，JDK 要求 JDK21。
• 需要安装 JDK，不能仅安装 JRE。仅安装 JRE 会导致 TongWeb 部分功能不能使用。
• Linux 下若使用 IBM JDK，则需要手动放置如下 jar 包到 “${tongweb.home}/lib/compatible” 目录，否则启动 TongWeb 失败。
◦ JDK 8.0 
```batch
bcprov-jdk15on-1.70.jar 
```
◦ JDK 8.0+ 
```batch
bcprov-jdk18on-1.78.1.jar 
```"
1 技术指标类 -> 1.2 支持的操作系统包含哪些？,"• Windows： 
Microsoft Windows 系列
• Linux： 
RedHat 系列、Suse Linux 系列、麒麟、统信 UOS、中科方德、欧拉等。
• Mac OS： 
Mac OS 系列"
1 技术指标类 -> 1.3 支持的数据库包含哪些？,"主流数据库：Oracle, MySQL5, MySQL8, Sybase 15, dameng, Kingbase, Kingbase8, Oscar, HSQL,Sybase type 4 for Sybase 11.x, jtds sybase, postgreSQL, SQLServer, Derby Client, Derby Embedded,IBM Type 4, gbase8t, gbase8s, sr, db2, highgo, uxdb, GaussDB 100, InspurK-DB, linkoopdb,OceanBase, MogDB 等。"
2 登录类 -> 2.1 验证码问题？,"在一些平台上，验证码无法正常显示，有两种解决方法（择其一即可）。
• 方法一：修改服务器 tongweb.xml（打开 Headless 系统配置模式）
![image](https://cdn-mineru.openxlab.org.cn/result/2026-02-12/74b543db-ed7f-4e00-9dd6-394d463bb982/26bcfec2544d99911182a6718877e3a764a8644fe666a417e84dd6eb65cba191.jpg)
◦ 系统默认开启 “服务器主配置文件防篡改”，TongWeb 运行期间禁止对主配置文件 “tongweb.xml” 进行修改。
◦ 若需要修改 “tongweb.xml”，请确保 TongWeb 服务器处于停止状态或 “服务器主配置文件防篡改”（可进入 “安全管理” $>$ “安全策略” $>$ “文件防篡改” 模块修改）关闭。
1. 进入 “${tongweb.base}/conf” 目录。
2. 打开 “tongweb.xml” 文件。
3. 将 “-Djava.awt.headless=true” 功能打开，如下所示。
```txt
<arg enabled=""true"">- Djava.awt.headless=true</arg> 
```
![image](https://cdn-mineru.openxlab.org.cn/result/2026-02-12/74b543db-ed7f-4e00-9dd6-394d463bb982/7bab9a23094c7e52c24c973da6e8e605767f10dd388652e3058d4bdff12e1dd8.jpg)
该操作可兼容大部分平台，该参数由 JDK 提供，打开后可能对应用性能有所影响。
• 方法二：修改服务器 console.xml（禁用验证码功能）
![image](https://cdn-mineru.openxlab.org.cn/result/2026-02-12/74b543db-ed7f-4e00-9dd6-394d463bb982/1a508c946c9e01d871c7d989b9427f987214dc630f4a069656fc7df2c7924dcf.jpg)
◦ 系统默认开启 “服务器主配置文件防篡改”，TongWeb 运行期间禁止对主配置文件 “console.xml” 进行修改。
◦ 若需要修改 “console.xml”，请确保 TongWeb 服务器处于停止状态或 “服务器主配置文件防篡改”（可进入 “安全管理” > “安全策略” > “文件防篡改” 模块修改）关闭。
1. 进入 “${tongweb.base}/conf” 目录。
2. 打开 “console.xml” 文件。
3. 将 “VerCodeEnabled” 参数设置为 “false”，可禁用验证码功能。"
2 登录类 -> 2.2 启动 TongWeb 服务器后，在本机通过命令修改密码时报错？,"问题现象：
启动 TongWeb 服务器后，通过命令修改密码时报错，如下图所示。
```ini
[root@centos bin]# sh commandstool.sh --model=password --action=update --username=thanos --password=Thanos123.com --acceptAgreement=true  
password=Thanos123.com newPassword=Thanos12.com confirmPassword=Thanos12.com  
Execute the command: commandstool  
连接失败，请检查连接的主机、端口是否正确或目标TongWeb是否已启动。  
[root@centos bin]#
```原因分析：
连接主机的端口号不正确，不再是默认的“9060”。
解决方案：
在执行的命令中，添加 “--port”，指向实际的端口。
1. 进入 “${tongweb.base}/conf” 目录。
2. 打开 “tongweb.xml” 文件，查看并获取控制台的端口，如 “8090”。
```xml
<connector SSLEnabled=""true"" address=""0.0.0.0"" clientAuth=""false"" keystoreFile=""conf/server.Keystore"" keystorePass=""jo+fvRppEjYJWnAqSYOpfg=="" maxSwallowSize=""2097152"" maxThreads=""24"" minSpareThreads=""5"" name=""admin"" port=""8090"" scheme=""https"" secure=""true"" sslEnabledProtocols=""TLSv1.2"" sslProtocol=""TLSv1.2"" systemManaged=""true"" truststoreFile=""conf/server.Keystore"" truststorePass=""jo+fvRppEjYJWnAqSYOpfg=="" /> 
```
3. 执行命令时，添加 “--port” 指向实际端口 $"" 8 0 9 0 ""$ ，如下所示。
```batch
sh commandstool.sh --model=password --action=update --username=thanos --password=thanos123.com  
--acceptAgreement=true --port=8090 originalPassword=thanos123.com newPassword=Thanos12.com  
confirmPassword=Thanos12.com 
```
4. 命令执行完成后，即可查看到“修改密码更新成功”的提示信息。"
2 登录类 -> 2.3 如何设置信任IP？,"出于安全考虑，TongWeb 对于非信任 IP 禁止登录 TongWeb 管理控制台。用户将无法进行任何操作。默认仅安装 TongWeb 的本机受信任。
当使用远程浏览器访问 TongWeb 控制台前，请在安装 TongWeb 的本机将远程浏览器所在主机的 IP 设置为“信任 IP”。
信任 IP 可为具体的 IP、匹配 IP 的正则表达式或通配符 IP（如：168.1.2.*，168.1.4.5-168.1.4.99）。
设置为 “*” 表示信任所有机器（不建议）。"
2 登录类 -> 2.3 如何设置信任IP？ -> 2.3.1 限制说明,"• 针对本机浏览器
安装 TongWeb 后，默认仅本机受信任，本机操作不受限制。
• 针对远程浏览器
在安装 TongWeb 的本机将远程访问 TongWeb 控制台的主机 IP 设置为 “信任 IP” 后，远程浏览器才有权限执行相关操作。"
2 登录类 -> 2.3 如何设置信任IP？ -> 2.3.2 限制现象,"当使用远程浏览器访问 TongWeb 控制台，并且没有设置信任 IP，可能会遇到 “该操作仅限于在服务器本机或受信任的IP上执行” 等提示信息，如下图所示。
![image](https://cdn-mineru.openxlab.org.cn/result/2026-02-12/74b543db-ed7f-4e00-9dd6-394d463bb982/e9d781a561602db73863e514c297c60666e7d773e6f512774ea11b981e4b204c.jpg)"
2 登录类 -> 2.3 如何设置信任IP？ -> 2.3.3 方式一：控制台设置信任IP,"注意事项：需要浏览器所在 IP 是服务器本机或者已受信任。
控制台设置信任IP
1. 登录 TongWeb 管理控制台。
2. 在控制台左上角，单击 “集中管理”，进入集中管理页面。
3. 在左侧导航栏中，选择 “安全配置” $>$ “控制台安全”，进入控制台安全页面。
![image](https://cdn-mineru.openxlab.org.cn/result/2026-02-12/74b543db-ed7f-4e00-9dd6-394d463bb982/6e43d5b777454a8f459e3c5beef1e4b20be8e48e4bf35809814cce6864347c29.jpg)
4. 配置信任 IP。
指定信任的客户端 IP 地址，其值可为具体的 IP、匹配 IP 的正则表达式或通配符 IP（如：168.1.2.*，168.1.4.5-168.1.4.99）。
5. 配置完成后，单击“更新”，即可完成控制台安全的配置。
若界面弹出“控制台安全更新成功”，则说明控制台安全配置成功。"
2 登录类 -> 2.3 如何设置信任IP？ -> 2.3.4 方式二：命令行设置信任IP,"启动 TongWeb，并进入 “${tongweb.home}/bin” 目录，执行如下命令，设置信任IP。
如下以信任IP为“192.168.1.1”为例说明。
```batch
sh commandstool.sh --username=thanos --password=Thanos12.com --acceptAgreement=true --model=consolesecurity --action=update trustedIP=192.168.1.1 
```
若设置的是正则表达式，则需要先进行编码，编码方式如下所示。
1. 进入 TongWeb 管理控制台。
2. 切换到目标实例。
3. 选择“基础配置” $"" > ""$ “加密工具”，进入加密工具页面。
4. 加密类型选择“特殊字符”。
5. 单击“加密”，即可得到加密结果。"
2 登录类 -> 2.3 如何设置信任IP？ -> 2.3.5 方式三：通过修改 console.xml 文件,"注意：
• 系统默认开启 “服务器主配置文件防篡改”，TongWeb 运行期间禁止对主配置文件 “tongweb.xml” 或“console.xml” 进行修改。
• 若需要修改 “console.xml”，请确保 TongWeb 服务器处于停止状态或 “服务器主配置文件防篡改”（“安全管理” $>$ “安全策略” $>$ “文件防篡改”）关闭。
console.xml 文件路径 “${tongweb.base}/conf/”。
为 console 节点添加或者修改 “trustedIP” 属性，设置完成后，需要重启 TongWeb 服务器，方可生效。
“trustIP” 可以设置为 IP、匹配 IP 的正则表达式或者通配符 IP。
如下以将 trustIP 设置为 IP 地址为例进行说明。
```txt
<console trustedIP=""192.168.1.1""> 
```"
2 登录类 -> 2.4 动态密码绑定不成功或登录验证不通过？,请确保服务器时间和手机时间保持一致。
2 登录类 -> 2.5 开启动态密码后，密钥丢失，怎么办？,"若动态密码丢失，您可以修改“${tongweb.base}/conf/console.xml” 里的 name=""用户名"" 节点的“enableOtp” 值的方式关闭动态密码。
注意事项
console.xml 为 TongWeb 主配置文件，具有防篡改限制。若需要修改并使其生效，请先停止 TongWeb 服务器，然后再进行修改。
操作步骤
1. 进入 “${tongweb.base}/conf” 目录。
2. 打开 “console.xml” 文件。
3. 将丢失密钥账户对应的 “enableOtp” 字段修改为 “false”，即可关闭动态密码。
修改位置，如下图所示。
![image](https://cdn-mineru.openxlab.org.cn/result/2026-02-12/74b543db-ed7f-4e00-9dd6-394d463bb982/5e3076cb09486a08998651e0f9a3eace09e944840c85809c7899ff615ba9cbdf.jpg)
4. 修改完成后，保存并退出。
5. 启动 TongWeb 服务器。
6. 登录 TongWeb 控制台时，可发现不输入动态密码，可成功登录到控制台。"
2 登录类 -> 2.6 密码丢失，如何找回密码？,"可通过修改 “${tongweb.base}/conf/console.xml” 里的 name=""用户名"" 节点的 password 值的方式重置为初始密码。
注意事项
console.xml 为 TongWeb 主配置文件，具有防篡改限制。若需要修改并使其生效，请先停止 TongWeb 服务器，然后再进行修改。
操作步骤
1. 进入 “${tongweb.base}/conf” 目录。
2. 打开 “console.xml” 文件。
3. 将丢失账户（如 “thanos” ）对应的 “password” 字段修改为如下字符串，即可重置为初始密码“thanos123.com”。
44D3$2$0B8AA118786066B2A9DF05A44B342AE2FC147F2164B5A9F232259E50DE5D9F1C$SHA-256 
修改位置，如下图所示。
![image](https://cdn-mineru.openxlab.org.cn/result/2026-02-12/74b543db-ed7f-4e00-9dd6-394d463bb982/e1a61e0fe5f893c8292dca1549369afe0b4b48a5e837132fdb35a03a83e6a879.jpg)
4. 将丢失账户（如 “thanos” ）对应的 “changeInitPwd” 字段修改为 “true”，要求该账户登录时，必须修改初始密码。
修改位置，如下所示。
![image](https://cdn-mineru.openxlab.org.cn/result/2026-02-12/74b543db-ed7f-4e00-9dd6-394d463bb982/6126033fa703f8ae90befeb6cb16b658067e246436ceeaa430914f93bbeba1d6.jpg)
5. 修改完成后，保存并退出。
6. 启动 TongWeb 服务器。
7. 使用重置后的初始密码，即可成功登录 TongWeb 控制台。"
2 登录类 -> 2.7 同一用户登录控制台后，再使用REST/JMX/命令行等接口接入，浏览器上的会话被强制退出？,"为了保证用户的登录安全，当使用某用户通过浏览器登录控制台后，若再使用相同的用户通过 REST\JMX\命令行等接口接入，该用户在浏览器上的会话会被强制终止（即被踢出，需要重新登录）。
例如：使用 thanos 账户登录 TongWeb 控制台，再使用该用户进行 JMX 接口接入，如下图所示。
![image](https://cdn-mineru.openxlab.org.cn/result/2026-02-12/74b543db-ed7f-4e00-9dd6-394d463bb982/7b0526255df693147cc4ffebf6428c30faf9741cc10c4773a587ba46b5419f89.jpg)
浏览器上的会话会被强制退出，如下图所示。
请确认
![image](https://cdn-mineru.openxlab.org.cn/result/2026-02-12/74b543db-ed7f-4e00-9dd6-394d463bb982/ee347e6f724261329e73decf0ddd563f608e9a05cf3e18dce909da5ad28db1dd.jpg)
用户未登录或会话已超时，请重新登录
重新登录
知道了"
3 启动类 -> 3.1 确认 TongWeb 并未启动，系统提示已启动，如何处理？,"问题现象：
确认 TongWeb 并未启动，但系统提示 TongWeb 已启动，如下所示。
```txt
[tongtech@backup bin]s ./startserver.shExecute the command: serverThe server is starting.ommandsstart> has beenexecuted.tongtech@backup bin]s 
```
```txt
Ready to <start> TongWeb: /home/tongtech/TongWebx.x.x/x/domains/domainl 
```
解决方案：
请尝试删除 “${tongweb.base}/data” 目录下的 “tongweb.pid”，然后重试。"
3 启动类 -> 3.2 如何指定启动 TongWeb 使用的 java 路径？,"指定启动 TongWeb 的 java 路径，按照优先级别可设置：
1. 打开 “${tongweb.base}/conf/tongweb.xml” 文件。
2. 在 <environments> 标签下，添加如下标签。
```txt
<env name=""JAVA_HOME"" value=""指定java路径（注意是bin的父目录）""/>
```
3. 修改当前用户的环境变量 JAVA_HOME，指定的启动 TongWeb 的java路径（注意是bin的父目录）。
4. 当前环境变量 PATH 中的第一个 java 路径。"
3 启动类 -> 3.3 Linux 下使用 IBM JDK 启动 TongWeb 失败？,"问题现象：
```txt
2024-07-16 17:01:17 >>> Ready to <start> TongWeb: domains/domain1  
Exception in thread ""main"" java.lang.IllegalArgumentException: java.lang.Null例外Exception at com.tongweb.BaseUtil.parseServerLic(Unknown Source)  
at com.tongweb.BaseUtil.getServerLic(Unknown Source)  
at com.tongweb.server.util.LicUtilities.getServerLic(Unknown Source)  
at com.tongweb.main.TongWebMain.c(Unknown Source)  
at com.tongweb.main.TongWebMain.main(Unknown Source)  
Caused by: java.lang.NumException at java.io.StringReader.<init>(StringReader.java:61)  
at com.tongweb.BaseUtil.a(Unknown Source) ... 5 more
```
```txt
2024-07-16 17:01:18 >> Command <start> has been executed. 
```
解决方案：
1. 手动将如下 jar 包放置于 “${tongweb.home}/lib/compatible” 目录。
◦ JDK 8.0 
```batch
bcprov-jdk15on-1.70.jar 
```
◦ JDK 8.0+ 
```batch
bcprov-jdk18on-1.78.1.jar 
```
2. 重新启动 TongWeb 服务器即可。"
3 启动类 -> 3.4 某些平台启动过慢？,"此问题源自Java语言的底层设计，解决办法：
1. 打开 tongweb.xml 文件。
2. 将 <arg enabled=""true"">-Djava.security.egd=file:/dev/./urandom</arg> 节点的 enabled 属性设置为true 或 false 以观察效果。"
3 启动类 -> 3.5 启动失败，报授权解密相关错误？,"对于少数情况，如 AIX 平台或 IBM JDK 环境，启动会出现授权解析失败问题，此时可尝试在
${tongweb.home}/lib/compatible 下添加 bcprov-jdk15on-1.70.jar（Jdk 8.0） 或 bcprov-jdk18on-1.78.1.jar（Jdk $8 . 0 +$ ） 依赖包，该包可自行从互联网或其它渠道获取。"
3 启动类 -> 3.6 启动失败，授权提示信息不明确？,"由于授权问题导致启动失败，其提示信息均为： Exception in thread ""main"" java.lang.RuntimeException: Licenseerror! Run version.[sh | bat] for detail.
此设计是出于安全考虑的，可在一定程度上防止追踪破解授权代码。
如此的提示信息难以了解具体的启动失败原因，您可以根据提示执行 version 脚本以得到更加详细的信息。"
3 启动类 -> 3.7 升级后启动失败， 提示重新解压？,"问题现象：
启动时报错 “The extracted version file may be incomplete and an atteempt is being made to re-unzipit…”，如下图所示。
```txt
[tongtech@localhost bin]$ ./startd.sh abc  
The extracted version file may be incomplete and an attempt is being made to re-unzip it...  
The extracted version file may be incomplete and an attempt is being made to re-unzip it...  
20 16:58:53 >> Server startup in 4 seconds  
[tongtech@localhost bin]$ 
```
原因分析：
操作系统字符集如果不支持中文，doc 下中文手册会导致 TongWeb 无法正常启动。
解决方案：
先手动解压升级包 “version*.zip” ，然后再启动 TongWeb。"
3 启动类 -> 3.8 集中管理中，启动实例失败时，找不到日志？,"在集中管理中，若启动实例失败，可优先在 server.log 中查找失败日志。
若在 server.log 中没有找到相关日志，再前往 “domain1/logs/subprocess” 目录中，查找最新时间的日志。
日志名称格式：类型-名称-时间戳.log
例如：TDG-TTT-20231010*.log"
3 启动类 -> 3.9 永久 license 启动报错，提示未及时激活？,"问题现象：
永久 license 启动报错，提示未及时激活？
```txt
[root@localhost bin]# sh startserver.sh License check failed: License not activated in time 
```
原因分析：
对于永久 license，用户在启动 TongWeb 后，系统会自动激活该 license，并且与 127.0.0.1 对应的 mac 地址进行绑定。
• 若永久 license 的创建时间（create_time）处于 90 天以内，用户可自由拷贝，且拷贝后的 license 均能正常完成激活与绑定操作。
• 若永久 license 的创建时间已超过 90 天，则该 license 将自动失效，无法再进行激活与绑定，进而导致TongWeb 无法正常启动。
解决方案：使用新的有效 license。"
4 集中管理类 -> 4.1 集中管理所在节点故障，如何恢复？,"若集中管理所在节点故障，可通过如下方式恢复对各节点的集中管理。
• 通过自动备份的 tongweb.xml 和 console.xml文件进行恢复。
tongweb.xml & console.xml备份路径：${tongweb.base}/data/conf/。
• 若配置文件丢失，可重新添加各节点。"
4 集中管理类 -> 4.2 如何查询受管实例的集中管理 IP？,"1. 打开受管实例的 “${tongweb.base}/conf/tongweb.xml” 文件。
2. 查看 <server> 标签的 “centralizedIp” 属性。
“centralizedIp” 属性记录了集中管理的 IP 地址。"
5 应用类 -> 5.1 支持部署的应用类型有哪些？,"TongWeb 支持五种 JavaEE 应用文件的类型，包括 Web 应用、EJB 应用、Connector 应用、EAR 应用、其他。有关应用类型的详细说明，请参见《TongWeb_V8.0控制台使用手册》。
<table><tr><td>类型</td><td>扩展名</td><td>用途和构成</td></tr><tr><td>Web应用</td><td>.war</td><td>包含 Servlet 和 JSP 等 Web 组件，EJB 组件以及静态 HTML 页面、Jar 文件、标记库等。</td></tr><tr><td>EJB应用</td><td>.jar</td><td>包含 EJB 实现以及 EJB 实现所需的类。</td></tr><tr><td>Connect应用</td><td>.rar</td><td>包含连接器（资源适配器）的实现类。</td></tr><tr><td>EAR应用</td><td>.ear</td><td>包含上述三种应用类型。</td></tr><tr><td>其它应用</td><td>.car</td><td>非标准格式的其他应用，选择此类应用文件后，只能通过后台获取其应用类型。</td></tr></table>"
5 应用类 -> 5.2 应用部署时间长或卡住？,"问题现象：
应用部署时间长或卡住不动，如下图。
![image](https://cdn-mineru.openxlab.org.cn/result/2026-02-12/74b543db-ed7f-4e00-9dd6-394d463bb982/d6193a0f64c8e6288c4ec5891d0bf85a6a4bbeeaaef982e9ae4572921bdb5f26.jpg)
原因分析：
可能是应用启动执行到某一初始化操作时间长引起的。
解决方案：
在应用部署过程中出现这种情况时，可以按照如下方式解决。
1. 重新刷新 TongWeb 管理控制台。
2. 打开“监视管理”>""阻塞线程""页面，找到""TW-0.0.0.0-9060-*""的部署线程。
3. 查看原因，通常是数据源阻塞、线程阻塞等问题。
![image](https://cdn-mineru.openxlab.org.cn/result/2026-02-12/74b543db-ed7f-4e00-9dd6-394d463bb982/ce35ea8538f6daee46735fb7b2f0bb17e48d6e9a6b10830ad91c488cbbec03bb.jpg)"
5 应用类 -> 5.3 开启异步请求报空指针？,部署应用选用线程池后，需要注意，访问应用响应时长超过通道中“异步请求的默认超时”时间后，会报请求超时和空指针问题。
5 应用类 -> 5.4 自动部署不生效？,"自动部署开关默认关闭。
若需要开启自动部署开关，请选择 “基础配置” > “全局配置” > “应用”，进入应用页面，打开“自动部署应用”开关。
![image](https://cdn-mineru.openxlab.org.cn/result/2026-02-12/74b543db-ed7f-4e00-9dd6-394d463bb982/3aa1a417bffc09ca246ee4e0f902709eb5adab14b550b550646e50041ae8dc63.jpg)
打开自动部署开关后，只需要将应用包拷贝到 “${tongweb.base}/autodeploy” 目录，即可自动部署该应用。
• 生成状态标签：开启该功能后，自动部署的应用将会生成对应的标签文件，成功：.deployed，失败：.failed，卸载 *.unDeployed。
• 部署到 deployment：开启该功能后，自动部署的非文件夹类型应用将解压部署到${tongweb.base}/deployment 目录，关闭该功能将在原地解压部署。
• 自动部署目录：指定自动部署的目录，默认为 “${tongweb.base}/autodeploy”。"
5 应用类 -> 5.5 自动部署应用时，文件尚未完成上传，系统日志就提示不是一个有效的应用？,"问题现象：
当从本地上传应用包到服务器时，由于应用包过大，超过 1 分钟都没有完成上传，日志提示不是一个有效的应用。
报错信息，如下所示：
```txt
2025-01-23 17:11:37 [ERROR] - Failed Deployment of: demotest-1.jar java.lang.reflect.InvocationTargetException at jdk.internal.reflect GENERATEDMethodAccessor111.invoke(Unknown Source) at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) at java.base/java.lang.reflect.Method.invoke(Method.java:568) at com.tongweb.ext.ExtServerFracade.doOperation0(ExtServerFracade.java:107) at com.tongweb.ext.ExtServerFracade.lambda$doOperation$0(ExtServerFracade.java:80) at com.tongweb server.util.Utds.runUnderClassLoader(Unknown Source) at com.tongweb.ext.ExtServerUtil. lambda$runUnderEnv$0(ExtServerUtil.java:49) at com.tongweb server.util. ServerUtil.traceLogException(Unknown Source) at com.tongweb.ext.ExtServerUtil. runUnderEnv(ExtServerUtil.java:49) at com.tongweb.ext.ExtServerFracade.doOperation(ExtServerFracade.java:80) at com.tongweb.ext.deploy.AutoDeployer deploymentsFile(AutoDeployer.java:273) at com.tongweb.ext.deploy.AutoDeployer. lambda$newFiles$5(AutoDeployer.java:231) at java.base/java.lang.Iterable.forEach(Iterable.java:75) at com.tongweb.ext.deploy.AutoDeployer.newFiles(AutoDeployer.java:224) at com.tongweb.ext.deploy.AutoDeployer.scan0(AutoDeployer.java:164) at com.tongweb.ext.deploy.AutoDeployer.scan(AutoDeployer.java:94) at com.tongweb.server.core.StandardEngineBACKGROUNDProcess(StandardEngine.java:132) at com.tongweb.server.core.ContainingBase-processChildren(ContainerBase.java:677) at com.tongweb.server.core.StandardEngine. Lambda$threadStart$0(StandardEngine.java:103) at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:539) at java.base/java.util.concurrent.FutureTask.runAndReset(FutureTask.java:305) at java.base/java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:305) at java.base/java.util.concurrent.ThreadPoolExecutorRunWorker ThreadPoolExecutor.java:1136) at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635) at com.tongweb.web.util threads. TaskThread$WrappingRunnable.run(TaskThread.java:47) at java.base/java.lang.Thread threads. run的任务线程任务线程任务线程任务线程任务线程任务线程任务线程任务线程任务线程任务线程任务线程任务线程任务线程任务线程任务线程任务线程任务线程任务线程任务线程任务线程任务线程任务线程任务线程任务线程任务线程任务线程任务线程任务线程任务线程任务线程任务线程任务线程任务线程任务线程任务
```
错误码，如下所示：
```txt
Caused by: com.tongweb.server.utilErrorCodeExceptionImpl errorCode:018 
```
errorCode:018 ：无法正常识别应用类型，请检查要部署的应用文件是否合法。
原因分析：
当应用包体积较大时，一旦开始上传，自动部署目录下会立即生成一个相应的目录，并且系统会尝试立即开始部署流程。然而，由于此时文件尚未完全上传，系统日志中会记录一条错误信息，指出当前的应用不是一个有效的应用包。
解决方案：
该报错信息并不会阻碍应用的部署进程；一旦文件全部上传完毕，应用便能顺利部署成功。
为了避免此类问题的发生，您可以参照如下步骤上传文件：
1. 首先，将应用包上传到服务器的某个指定目录。
2. 然后，使用 mv 命令，将应用包作为一个整体一次性移动到自动部署目录中，即可避免文件不全的问题。"
5 应用类 -> 5.6 自动部署应用时，如果加载了 dll 本地库，应用无法卸载和升级？,"问题1：自动部署导致应用无法完全卸载
1. 开启自动部署，重启 TongWeb；
2. 将 xx.war 文件放置于自动部署目录中，观察到生成了 xx.war.deployed 文件，表明应用已成功部署；
3. 手动从自动部署目录中删除 xx.war 文件；
4. 通过 TongWeb 打印的日志可以看到，应用卸载成功后，紧接着又去部署了 xx.war 应用。
问题2：应用升级出现重复应用
1. 开启自动部署，重启 TongWeb；
2. 把 xx.war 放入自动部署目录，确认应用已成功部署（生成了 xx.war.deployed）；
3. 准备一个更新版本的 xx.war 文件，将其替换自动部署目录中原有的同名文件以进行升级操作；
4. 登录 TongWeb 控制台，在 “应用” 列表中发现存在两个 xx.war 应用。
解决方案：
方式1：
1. 释放 dll 本地库；
2. 重启 TongWeb。
方式2：
为了避免此问题，您可以选择不升级或卸载应用，或者选择去控制台部署应用。
然而，在控制台部署应用后，如果您尝试点击卸载应用，虽然表面上看似卸载成功，但实际上手动去删除应用，会提示 dll 被占用。要彻底删除应用，您必须先停止 TongWeb 服务。"
5 应用类 -> 5.7 自动部署目录下的应用文件被外部删除后，每次启动都报找不到应用？,"屏蔽日志的方式：
1. 在控制台上删除该应用；
2. 修改 $\$ 1$ {tongweb.base}/conf/tongweb.xml，将该应用对应的节点删除。"
5 应用类 -> 5.8 删除自动部署目录下的应用有.unDeployed 文件？,这个文件是个标记，告诉用户出现这个表示卸载已成功结束，用户看到之后可自行选择删除这个文件，删除不会有任何影响。
5 应用类 -> 5.9 更新 JSP 文件后，没有实时生效？,"更新 JSP 文件后，若需要实时生效，请进入已部署应用的详细配置页面。在“JSP”页签下，开启“开启JSP开发模式”开关。
![image](https://cdn-mineru.openxlab.org.cn/result/2026-02-12/74b543db-ed7f-4e00-9dd6-394d463bb982/535aba9d528a9d7b97ffad84320393002d41f904942ba00c23b3116e83a7cc23.jpg)
开启 JSP 开发模式后，当有 JSP 文件更新时，更新的文件会在 5 秒内重新加载以生效。
 若开启了资源缓存，生效时间会在资源的缓存时长后。"
5 应用类 -> 5.10 Cookie 异常字符报错？,"问题现象：
报“An invalid domain [.test.com] was specified for this cookie”错，如下所示。
```txt
2022-06-14 11:07:31 [WARN] - java.lang.IllegalArgumentException: An invalid domain [.test.com] was specified for this cookie  
2022-06-14 11:07:31 [WARN] - at  
com.tongweb.web.util(http.Rfc6265CookieProcessorValidateDomain(Rfc6265CookieProcessor.java:202)  
2022-06-14 11:07:31 [WARN] - at  
com.tongweb.web.util(http.Rfc6265CookieProcessor_generateHeader(Rfc6265CookieProcessor.java:137)  
2022-06-14 11:07:31 [WARN] - at  
com.tongweb.serverconnector.Response_generateCookieString(Response.java:960) 
```
解决方案：
在应用配置中，开启“使用老版 Cookie 处理器”。
![image](https://cdn-mineru.openxlab.org.cn/result/2026-02-12/74b543db-ed7f-4e00-9dd6-394d463bb982/65d54defb35464c9f86372a1b9af5045f63bd61bb8ae286d0554fe24c7537c7d.jpg)"
5 应用类 -> 5.11 URI 中有非法字符报错？,"问题现象：
报“Invalid character found in the request target”错，如下所示。
```txt
2022-06-14 10:16:24 [INFO] - Error parsing HTTP request header  
Note: further occurrences of HTTP request parsing errors will be logged at DEBUG level.  
java.lang.IllegalArgumentException: Invalid character found in the request target [/dbpool/?aa=|ddd]]. The valid characters are defined in RFC 7230 and RFC 3986  
at com.tongweb.coyote(http11 Http11InputBuffer.parseRequestLine( Http11InputBuffer.java:470)  
at com.tongweb.coyote(http11 Http11Processor.service( Http11Processor.java:212) 
```
解决方案：
在目标 HTTP 通道中，开启“路径中允许使用的未编码字符”和“参数中允许使用的未编码字符”，并配置“"" <$> [ \backslash ] \land \{ | \} ^ { * } ,$ 。
操作步骤，如下所示。
1. 登录管理控制台。
2. 切换到目标实例。
3. 在左侧菜单栏中，选择 “Web 容器” $>$ “通道”，进入通道列表页面。
4. 单击目标通道的通道名，进入通道详细信息页面。
5. 单击 “HTTP 属性” 页签，打开 “路径中允许使用的未编码字符” 和 “参数中允许使用的未编码字符” 开关。
通道／创建☆
![image](https://cdn-mineru.openxlab.org.cn/result/2026-02-12/74b543db-ed7f-4e00-9dd6-394d463bb982/a41d84f6a9e138959c49f219e498368d7cc2cce0d37f0f12bf7ab3d12df08f20.jpg)"
5 应用类 -> 5.12 JSP 编译报错？,"问题现象：
报“quoted with [""] which must be escaped when used within the value”错，如下所示。
```txt
2022-06-14 11:24:55 [WARN] - com.tongweb.jasper.JasperException: /index2.jsp (line: [11], column: [45])  
Attribute value [String.valueOf(""aa"")] is quoted with [""] which must be escaped when used within the value  
2022-06-14 11:24:55 [WARN] - at  
com.tongweb.jasper.compile.DefaultErrorHandler.jspError(DefaultErrorHandler.java:26)  
2022-06-14 11:24:55 [WARN] - at  
com.tongweb.jasper.compile.ErrorDispatcherdispatch(ErrorDispatcher.java:276) 
```
解决方案：
在应用配置中，关闭“Strict Quote Escaping”。
![image](https://cdn-mineru.openxlab.org.cn/result/2026-02-12/74b543db-ed7f-4e00-9dd6-394d463bb982/07b41f1b079568c7f038696d631b80dba7975e0465a6ba891c1cf44d59896664.jpg)"
5 应用类 -> 5.13 应用部署缓存不足告警？,"问题现象：
报“because there was insufficient free space available after evicting expired cache entries - considerincreasing the maximum size of the cache”错，如下所示。
```txt
2022-06-14 12:16:39 [WARN] - Unable to add the resource at [/WEB-INF/classes/org/oasis_open/docs/wsrf/np_2/jaxb.properties] to the cache for web application [cxf] because there was insufficient free space available after evicting expired cache entries - consider increasing the maximum size of the cache  
2022-06-14 12:16:39 [WARN] - Unable to add the resource at [/WEB-INF/classes/org/oasis_open/docs/wsrf/np_2/jaxb.properties] to the cache for web application [cxf] because there was insufficient free space available after evicting expired cache entries - consider increasing the maximum size of the cache 
```
解决方案：
应用部署增大 “最大缓存大小”，通常大于应用所有 jar 的大小，通过应用监控缓存使用情况。
查看资源缓存量是否够用，再调整“最大缓存大小”。
1. 选择 “应用管理” $>$ “应用”，进入应用/列表页面。
2. 单击目标实例所在行的 “监视”，进入监视页面，查看资源缓存量是否够用。
![image](https://cdn-mineru.openxlab.org.cn/result/2026-02-12/74b543db-ed7f-4e00-9dd6-394d463bb982/ddff3919c62ae6487762b4d86c48ea31257aae3a5541329509bba7b7f50aeed0.jpg)
3. 进入应用配置页面，对缓存进行调整。
![image](https://cdn-mineru.openxlab.org.cn/result/2026-02-12/74b543db-ed7f-4e00-9dd6-394d463bb982/226afc546c2cfe5c8185da1b462777489b7bf6fd73d72b90fe9a0d683b425547.jpg)
注意：
切记盲目调大，典型毛病“999999999”。"
5 应用类 -> 5.14 WebService 异常报错？,"问题现象：
报错信息，如下所示。
```txt
Caused by: org.xml.sax.SAXParseException: 文件提前结束。  
at com.sun.org.apache.xerces/internal.parsers.DOMParser.parse(DOMParser.java:262)  
at com.sun.org.apache.xerces/internal.jaxp.DocumentBuilderImpl数据分析(DocumentBuilderImpl.java:339)  
at com.tongweb.ws.commons schemaXmlSchemaCollection$2.run(XmlSchemaCollection.java:651)  
at com.tongweb.wscommons schemaXmlSchemaCollection$2.run(XmlSchemaCollection.java:649)  
at java.security.AccessController.doPrivileged(Native Method)  
at com.tongweb.wscommons schemaXmlSchemaCollection数据分析(XmlSchemaCollection.java:649)  
at com.tongweb.wscommons schemaXmlSchemaCollection.read(XmlSchemaCollection.java:618)  
... 64 more
```
解决方案：
从异常“com.tongweb.ws.commons.schema”可以看出 TongWeb 的 WebService 参与了应用的 xml 处理。
可在部署应用时，勾选加载应用的 “Webservice” 或 “Web 兼容模式”，即可解决该问题。
注意：
1. 用户需要进入 “基础配置” $>$ “全局配置” $>$ “服务器” 页签，打开 “启用 Webservice” 开关。
2. 在应用的 “资源加载” 页面中 “加载应用实现” 里才会显示 “WebService”。
![image](https://cdn-mineru.openxlab.org.cn/result/2026-02-12/74b543db-ed7f-4e00-9dd6-394d463bb982/7541951b1ae0692d7d3f9949364425d26693ce01ab52502e4ae6c16e3fca2e25.jpg)"
5 应用类 -> 5.15 与应用类冲突报错？,"问题现象：
```javascript
Caused by: java.lang.AbstractMethodError:  
javax.swing.core-UrlBuilder.uri(Ljava/lanl/String);Ljavax/ws/rs/core/UriBuilder;at javax.ws.rs.core.UrlBuilder.fromUri(UrlBuilder.java:96)at com.sun.JerseySpi container.servlet.ServletContainer.service(ServletContainer.java:669)at javax.swinghttp.HttpServlet.service(HttpServlet.java:590) 
```
解决方案：
在开启 “Web 兼容模式” 的情况下，依旧加载 “tongweb-jee-api.jar” 中的类，可以设置 “强制从应用加载的类” 来解决。
![image](https://cdn-mineru.openxlab.org.cn/result/2026-02-12/74b543db-ed7f-4e00-9dd6-394d463bb982/272ef4768efb4dfc4805ac68364d102c94f098773d15847fd7d922baaf31d5db.jpg)"
5 应用类 -> 5.16 获取另一应用上下文为空？,"问题现象：
通过request.getServletContext().getContext(""/app"")获取另一应用上下文为空。
解决方案：
在应用配置的“安全”页签下，开启“允许跨应用访问”。
![image](https://cdn-mineru.openxlab.org.cn/result/2026-02-12/74b543db-ed7f-4e00-9dd6-394d463bb982/f680bb5e231cb87b9a8eb479e9ff013e24d9e935175d0f7e8c547fac631eddb8.jpg)"
5 应用类 -> 5.17 编码设置问题？,"在遇到中文问题时，通常需要通过设置编码格式来解决问题。
下面介绍编码设置及优先级。
• web.xml中请求、响应编码的配置优先级最高
在JavaEE8规范中，web.xml 增加了 request、response编码配置，该配置优先级最高。
```xml
<?xml version=""1.0"" encoding=""UTF-8""?>   
<web-app xmlns:xsi=""http://www.w3.org/2001/XMLSchema-instance"" xmlns=""http://xmlns.jcp.org/XML/ns/javaee"" xsi: schemaLocation=""http://xmlns.jcp.org/XML/ns/javaee http://xmlns.jcp.org/XML/ns/javaee/webapp_4_0.xsd"" id=""WebApp_ID"" version=""4.0""> <display-name> charset</display-name> <default-context-path>/testde</default-context-path> <request-character-encoding>GBK</request-character-encoding> <response-character-encoding>GBK</response-character-encoding>   
... 
```
在以往的项目中，request、response 编码通常通过 filter 来设置，如下所示。
```txt
...
<filter-name>EncodingFilter</filter-name>
<filter-class>
    org.springframework.web.filter.CharacterEncodingFilter
</filter-class>
<init-param>
    <param-name>encoding</param-name>
    <param-value>UTF-8</param-value>
</init-param>
<init-param>
    <param-name>forceEncoding</param-name>
    <param-value>true</param-value>
</init-param>
... 
```
• 控制台编码设置
在部署应用时通过配置""编码""来完成。
![image](https://cdn-mineru.openxlab.org.cn/result/2026-02-12/74b543db-ed7f-4e00-9dd6-394d463bb982/2d677fb9a10b61d1ee9cdc4b143e6ff6e1f4992a584840841717f80d9e488038.jpg)
参数说明，如下表所示。
<table><tr><td>参数</td><td>参数说明</td></tr><tr><td>应用请求编码</td><td>应用程序的默认 HTTP 请求编码，优先级低于 web.xml。</td></tr><tr><td>应用响应编码</td><td>应用程序的默认 HTTP 响应体编码，优先级低于 web.xml。</td></tr><tr><td>JSP 文件编码</td><td>指定 JSP 文件编码，相当于javaEncoding。</td></tr><tr><td>静态文件编码</td><td>使用指定的编码解析应用的文件资源，如 *.html 等静态资源，可用于解决文件编码和 JVM 默认编码不一致引起的乱码问题。相当于fileEncoding。</td></tr></table>
• URL编码设置
为兼容 tomcat 编码，HTTP 通道中""其它""中的""URI 编码""相当于tomcat的URIEncoding；“URI 使用Content-Type 解码""相当于tomcat的useBodyEncodingForURI。
![image](https://cdn-mineru.openxlab.org.cn/result/2026-02-12/74b543db-ed7f-4e00-9dd6-394d463bb982/a5453e75abbe791b969c29343f82d3b90da10b7a3475ba96ab8fcf2ef912c147.jpg)"
5 应用类 -> 5.18 应用慢线程检测问题？,"在应用运行过程中，可能会有一些线程因等待锁、阻塞导致执行时间慢。这时可以开启 TongWeb 的""慢线程检测""功能来排查问题。
![image](https://cdn-mineru.openxlab.org.cn/result/2026-02-12/74b543db-ed7f-4e00-9dd6-394d463bb982/12ea84fed8e15933aedd585137aed512ede6697c38995370c64f7b436b2d7f24.jpg)
当 http 线程超过""阻塞阈值""时，则日志输出相应线程堆栈。通过大量收集该日志样本，以判断线程慢的原因。
![image](https://cdn-mineru.openxlab.org.cn/result/2026-02-12/74b543db-ed7f-4e00-9dd6-394d463bb982/966bb408d8e4748ccb3517235464f7f56c31d7c01342002146ec8375386e4df7.jpg)
仅收集一、两个该日志，不能说明线程慢在该处。
2023-02-14 15:29:53 [WARN] - Thread [TW-0.0.0.0-8088-1] (id=[61]) has been active for [20,131] milliseconds (since [2/14/23 3:29 PM]) to serve the same request for [ http://192.168.55.159:8088/webtest01/TestServlet] and may be stuck ( configured threshold for this StuckThreadDetectionValve is [20] seconds). There is/are [1] thread(s) in total that are monitored by this Valve and may be stuck. java.lang.Throwable 
```txt
at java.lang.Thread.sleep(Native Method)   
at com.tong.TestServlet.doGet(TestServlet.java:41)   
at javax.servlet.http(HttpServlet.service(HttpServlet.java:503)   
at javax.servlet.http HttpServlet.service(HttpServlet.java:590)   
at com.tongweb.server.core.ApplicationFilterChain.entryApp(ApplicationFilterChain.java:365) 
```
""中断阈值""通常不建议开启，因为实际应用场景中线程有业务相关逻辑，中断线程可能造成业务的不完整。若能确保中断线程无问题，则可开启。相关日志如下所示。
```txt
2023-02-14 15:29:59 [WARN] - Thread [TW-0.0.0.0-8088-1] (id=[61]) has been interrupted because it was active for [26,177] milliseconds (since [2/14/23 3:29 PM]) to serve the same request for [ http://192.168.55.159:8088/webtest01/TestServlet] and was probably stuck (configured interruption threshold for this StuckThreadDetectionValve is [25] seconds). java.lang.Throwable at java.lang.Thread.sleep(Native Method)   
at com.tong.TestServlet.doGet(TestServlet.java:41)   
at javax.servlet.http(HttpServlet.service(HttpServlet.java:503)   
at javax.servlet.http HttpServlet.service(HttpServlet.java:590)   
at com.tongweb.server.core.ApplicationFilterChain.enterApp(ApplicationFilterChain.java:365) 。。。。。。。。   
2023-02-14 15:30:01 [WARN] - Thread [TW-0.0.0.0-8088-1] (id=[61]) was previously reported to be stuck but has completed. It was active for approximately [26,177] milliseconds. 
```
""中断阈值""只中断 TongWeb 的 http 线程，若应用自建线程出现阻塞，可通过""监视管理"">""阻塞线程""查看，该功能为监控的JVM所有线程。""强停""功能同样谨慎使用。
阻塞线程 $\bullet$ /列表☆  
线程ID 线程名 线程状态 阻塞方法  
相同阻塞 Q搜索  
序号 线程ID 线程名 线程状态 阻塞方法 相同阻塞线程数 操作  
1 118 Thread-31 TIMED_WAITING java.lang.Thread.sleep(NativeMethod) 1 X强停  
2 18 mysql-cj-abandoned-connection-cleanup TIMED_WAITING java.lang.Object.wait(NativeMethod) 1 X强停
![image](https://cdn-mineru.openxlab.org.cn/result/2026-02-12/74b543db-ed7f-4e00-9dd6-394d463bb982/9857f9149af77b0bc9a6689ed04a34696b2c702d7a57b068c7c3fa6b4c7048cb.jpg)
当遇到线程阻塞类问题时，主要通过 TongWeb 提供的线程堆栈来分析问题，从应用侧来解决。对于""中断阈值"", ""阻塞线程""的""强停""功能需谨慎使用。
若http通道的线程和队列占满，则报错，如下所示。
```txt
2023-02-24 13:58:57.963 [WARN] [TW-0.0.0.0-8088-ClientPoller] [com.tongweb.web.util threads] - Executor  
rejected socket [ com.tongweb.web.util.net.NioEndpoint\$Nio SOCKETWrapper@fa310e2:  
com.tongweb.web.util.net2023-02-24 13:58:57.963 [WARN] [TW-0.0.0.0-8088-ClientPoller]  
[com.tongweb.web.utilThreads] - Executor rejected socket  
[com.tongweb.web.util.net.NioEndpoint\$Nio SOCKETWrapper@fa310e2:com.tongweb.web.util.net.NioChannel@1  
2bd59a6:java.nio_channels.SocketChannel[connected local=/127.0.0.1:8088 remote=/127.0.0.1:64068]] for  
processing java.util.concurrent-RejectedExecutionException: Queue capacity is full 
```
at com.tongweb.web.utilThreads.ThreadPoolExecutor.execute ThreadPoolExecutor.java:138)   
at com.tongweb.web.utilThreads.ThreadPoolExecutor execute( ThreadPoolExecutor.java:109)   
at com.tongweb.web.util.netat   
com.tongweb.web.util.net.AbstractEndpoint(processSocket( AbstractEndpoint.java:938)   
at com.tongweb.web.util.netat   
com.tongweb.web.util.net.NioEndpoint\\(Poller.processKey(NioEndpoint.java:1366)   
at com.tongweb.web.util.net.NioEndpoint\\)Poller.run(NioEndpoint.java:1338)   
at java.lang.Thread.run( Thread.java:750)"
5 应用类 -> 5.19 如何更好的兼容 Web 应用？ -> 5.19.1 开启“轻量模式”对整个 TongWeb 生效,"此模式会关闭 EJB、JCA 等服务，并尝试从应用自身加载 JSF、JavaMail、WebService、Xml 等技术实现。若应用是基于 Tomcat 或其它 Servlet 容器开发，则通常可以获得更好的兼容性。
![image](https://cdn-mineru.openxlab.org.cn/result/2026-02-12/74b543db-ed7f-4e00-9dd6-394d463bb982/875d5e10324219bbd2c906318b26ac559a69582ba92983418a3c01fc9166b90f.jpg)"
5 应用类 -> 5.19 如何更好的兼容 Web 应用？ -> 5.19.2 部署应用时开启“web兼容模式”,"以 Web 兼容模式加载该应用。若该应用是基于 Tomcat 等 Web 容器开发，则可以尝试打开此开关以获得更好的兼容性。
开启此模式后，EJB 等企业级技术实现将不再支持，同时尝试从应用自身加载
JSF、JavaMail、WebService、Xml 等企业级技术实现。
![image](https://cdn-mineru.openxlab.org.cn/result/2026-02-12/74b543db-ed7f-4e00-9dd6-394d463bb982/577b4c751e27d894d5a2d6dc6f8c4c808613e05bfd16ab61145148a0fb667635.jpg)"
5 应用类 -> 5.20 什么情况下开启 “Web兼容模式” 或 “轻量模式”？,"• Web兼容模式
“Web 兼容模式” 仅对单个应用生效，是用户在部署应用时，对单个应用的配置，属于应用内存级别的隔离，隔离效果有限。
当用户需要同时部署 EJB 和 Web 应用的情况下，单独对 Web 应用开启。
• 轻量模式
轻量模式是全局生效，隔离更彻底，等同于 TongWeb 轻量级版本的物理级隔离。
若用户只有 Web 应用而没有 EJB 应用，推荐使用“轻量模式”。"
5 应用类 -> 5.21 从 root 用户切换到普通用户后，再启动 TongWeb，报错 “The scratchDir you specified:[xxxx] isunusable”？,"问题描述：
从 root 用户切换到普通用户后，启动 TongWeb，系统报错 “The scratchDir you specified:[xxxx] isunusable”？
1. TongWeb 安装目录的权限给到 777 。
2. 使用 root 用户启动 TongWeb，并部署一个 war 应用，然后访问应用。
3. 关闭 TongWeb。
4. 切换到普通用户（如：test）启动 TongWeb。
5. 启动后，系统报错 “The scratchDir you specified:[xxxx] is unusable”。
部署的 war 应用，点击链接报错。
```txt
2025-02-27 10:30:45 [INFO] - default: Failed to mkdirs of ExtremeMode_p_c.  
2025-02-27 10:30:45 [ERROR] - The scratchDir you specified: [/home/ domains/domain1/temp/cache/work/admin/admin/console] is unusable.  
2025-02-27 10:30:45 [INFO] - contextRoot: console  
2025-02-27 10:30:45 [INFO] - --admin -> console deployed in 58128 ms  
2025-02-27 10:30:45 [INFO] - --localhost -> TestProject, priority 99  
2025-02-27 10:30:46 [INFO] - Init service: Default Managed Container  
2025-02-27 10:30:46 [INFO] - Creating a container for bean TestProject.Comp1562090557: Container(type=MANAGED, id=Default Managed Container)  
2025-02-27 10:30:46 [INFO] - Creating Container(id=Default Managed Container)  
2025-02-27 10:30:46 [INFO] - Stateful session passivation directory: temp/cache/ejb  
2025-02-27 10:30:46 [INFO] - Application loaded: deployment/TestProject  
2025-02-27 10:30:46 [INFO] - Assembling app: deployment/TestProject  
2025-02-27 10:30:46 [INFO] - Deploying app: deployment/TestProject  
2025-02-27 10:30:47 [INFO] - Scanned JAR without TLD, consider skipping unneeded JARs.  
2025-02-27 10:30:47 [INFO] - ----TestListener----  
2025-02-27 10:30:47 [ERROR] - The scratchDir you specified: [/home/ domains/domain1/temp/cache/work/server/localhost/TestProject] is unusable.  
2025-02-27 10:30:47 [INFO] - contextRoot: TestProject  
2025-02-27 10:30:47 [INFO] - --localhost -> TestProject deployed in 1307 ms  
2025-02-27 10:30:47 [INFO] - Server startup in 63 seconds  
2025-02-27 10:30:47 [INFO] - 
```
原因分析：
切换为普通用户后，root 用户生成的 temp 文件导致部署的应用异常。
解决方案：
使用普通用户启动 TongWeb 前，删除 “${tongweb.base}/temp” 文件夹。"
6 数据源类 -> 6.1 如何快速回收数据库连接？,"基于数据源连接池的设计，空闲连接的回收机制是依赖连接的时间戳来判定是否需要回收，即便只有一个连接在循环使用连接池，也会顺次“激活”所有的连接，使得所有连接的时间戳始终是新的，因此不会被回收。只有在没有任何请求的情况下，超过最大空闲时间才会被回收掉。
对于需要快速回收数据库连接的场景，用户可尝试开启 “使用 LIFO 队列” 功能，使用后进先出类型的队列存储数据库连接。
“使用 LIFO 队列” 默认“开启”。
若没有开启，用户可参照如下操作步骤，开启 “使用 LIFO 队列” 功能。
1. 登录 TongWeb 管理控制台。
2. 切换到目标实例。
3. 在左侧菜单栏中，选择 “Web 容器” $>$ “数据源”，进入数据源列表页面。
4. 打开已创建的数据源，单击 “连接池”，进入连接池页签。
![image](https://cdn-mineru.openxlab.org.cn/result/2026-02-12/74b543db-ed7f-4e00-9dd6-394d463bb982/86b0a6086ec8f6eccbee813ae0931a6ed5a56ae24402259b86c235d814c0ed41.jpg)
5. 打开 “使用 LIFO 队列” 开关。
6. 开启完成后，单击 “更新”，即可完成 “使用 LIFO 队列” 的开启操作。"
6 数据源类 -> 6.2 如何获取数据库连接池关联的物理连接？,"首先通过JNDI获取到连接池返回的逻辑连接，然后调用
com.tongweb.tongejb.resource.jdbc.managed.util.NativeJdbcExtractor 类（所在jar包位
于${tongweb.home}/version<版本号>/modules/ejb/tongweb-ejb.jar）的 extractNativeConnection 方法
，将前面获取到的逻辑连接作为参数传递给此方法，该方法返回的结果即为该逻辑连接关联的物理连接。"
7 EJB服务类 -> 7.1 无状态会话Bean实例总数的监视为何会有跌落回升表现？,无状态会话Bean实例在使用完毕后会进入“重新初始化”状态，此时会从池中移除，因此看到实例总数跌落，待初始化完毕后会重新回到池中，此时可以看到总数又回升。
7 EJB服务类 -> 7.2 使用w3协议，首次访问ejb应用可以成功，过10秒后再次访问应用，会出现空白页并抛异常？,"解决方案：
• 方案一：
修改“EJB w3协议”>“连接配置”>“读超时时间”，把值改大一些。
把“读超时时间”调大，连接保持时间会更久一些。
• 方案二：
在“基础配置”>“启动参数”，添加 -Dtongejb.client.keepalive=PING_PONG 。
添加启动参数，性能会稍微降低。"
8 监视类 -> 8.1 监视数据为 -1？,监视数据为 -1，表示相应的监视功能未开启。
8 监视类 -> 8.2 无法监控到应用数据源？,"• 使用监控应用数据源功能，需要进入“基础配置”>“全局配置”>“应用”，在应用页面，打开 “监视应用数据源”开关。并且，在应用数据源初始化完成后，才能监控到。
![image](https://cdn-mineru.openxlab.org.cn/result/2026-02-12/74b543db-ed7f-4e00-9dd6-394d463bb982/7a14e119e9a1abbfe5686a5b4fae99b5dfc097e3ef2506f74642c93fe42c2b7d.jpg)
• 请确保 JDBC 连接池类型为 HikariCP、Druid、DBCP、C3P0、BeeCP、BoneCP、Tomcat 或者 Hulk。
• DBCP、C3P0、BoneCP 目前暂不支持监控“线程等待数”，即该监控值始终为 “-1”。"
9 日志类 -> 9.1 异常日志：All other methods are uncovered,"在web.xml中指定deny-uncovered-http-methods元素，在<web-resource-collection>使用<http-method>只配置了部分HTTP方法时，例如：
```xml
<deny-uncovered-http-methods/>   
<security-constraint>   
<display-name>Example Security Constraint</display-name>   
<web-resource-collection>   
<web-resource-name>Protected Area</web-resource-name>   
<url-pattern>/successful.jsp</url-pattern>   
<http-method>DELETE</http-method>   
<http-method>GET</http-method>   
<http-method>POST</http-method>   
<http-method>PUT</http-method>   
</web-resource-collection>   
<auth-constraint>   
<role-name>admin</role-name>   
</auth-constraint>   
</security-constraint> 
```
如果在web.xml文件中指定了deny-uncovered-http-methods元素，那么容器将拒绝任何未涵盖的HTTP方法，并返回403(SC_FORBIDDEN)状态码。 应用部署时会记录日志信息：
```txt
Adding security constraints with URL pattern [/successful.jsp] to deny access with the uncovered HTTP methods that are not one of the following [DELETE POST GET PUT]. 
```
如果未在web.xml文件中指定deny-uncovered-http-methods元素，将不会增加配置的URL Pattern的安全约束。 应用部署时会记录错误日志信息：
```txt
For security constraints with URL pattern [/successful.jsp] only the HTTP methods [DELETE POST GET PUT] are covered. All other methods are uncovered. 
```"
10 安全类 -> 10.1 启动 TongWeb 后，修改并保存console.xml，文件的修改被还原？,"TongWeb 提供“服务器主配置文件防篡改”功能，该功能默认为开启状态。
开启后，禁止在 TongWeb 运行期间对主配置文件 tongweb.xml、console.xml 等进行修改。
若被意外篡改，则自动进行恢复。
若需要关闭该功能，可进入“安全管理”>“安全策略”>“文件防篡改”，进入文件防篡改页签，可关闭“服务器主配置文件防篡改”。
为保证服务器主配置文件安全不被篡改，不建议关闭。"
11 通知类 -> 11.1 通知的详情表示什么含义？,当有系统配置属性改变，服务器需要重新启动才能生效时，系统会给出一条通知，其“详情”一般表示具体的发送变化的属性名，以及其变化前后的值。若变化的属性有多个，则会以分号分隔来表示。此外，属性发生变化后，若再次编辑将其恢复为启动之初的值，则重启 TongWeb 通知会取消。
11 通知类 -> 11.2 通知的内容是什么？,"• 通知的内容范围力求包含所有需要管理员介入的操作提醒，一般包含系统模块变更后的重启 TongWeb提醒信息和许可即将到期或已经过期的提醒信息。
• 可发布通知的模块包括但不局限于 “全局配置”、“无状态 EJB”、“有状态 EJB”、“单例 EJB”、“EJB 连接”、“启动参数”、“系统日志” 以及授权到期的提醒。
• 控制台上显示的通知条目不会自动更新，需要手动刷新网页以更新。"
12 其他类 -> 12.1 高并发压测只有5个工作线程？,可能和授权（license.dat）有关，试用和教学用的授权有最大并发处理线程为5的限制，请尝试检查并更换授权以解决此问题。
12 其他类 -> 12.2 服务器返回的密码全是固定的*号？,此设计是出于安全考虑的，密码不能泄漏出去，即使加密了也不能。
12 其他类 -> 12.3 SSL 加密套件在 IBM 平台和其它平台不一致？,"IBM MQ 支持的 CipherSpec 及其对应的 CipherSuite： https://www.ibm.com/docs/zh/ibm-mq/9.1?
topic=java-tls-cipherspecs-ciphersuites-in-mq-classes"
12 其他类 -> 12.4 IP 匹配规则是什么？,"信任的IP、拦截的IP、爬虫的IP均使用如下统一匹配规则：
1. 支持通配符*，比如10.10.45.*
2. 支持指定IP区间，比如10.10.45.1-10.10.45.250
3. 支持指定的IP，比如0.10.45.5
4. 支持同时指定多个规则，规则之间使用英文逗号分隔。比如10.10.45.*,10.10.45.1-10.10.45.250
5. 以上规则同时支持ipv4和ipv6"
12 其他类 -> 12.5 如何通过 TongWeb JCA 连接消息服务器 IBM MQ？,"以下是使用 TongWeb JCA 连接消息服务器 IBM MQ 的详细配置步骤：
1. 获取 IBM MQ 自带的 rar 适配器
◦ 文件名： wmq.jmsra.rar
◦ 默认路径：通常位于 “${IBMMQ_HOME}/java/lib” 目录
2. 部署 rar 适配器
a. 在 TongWeb 控制台的左侧菜单栏中，选择 “应用管理” > “应用”，进入应用列表页面。
b. 单击 “部署”，进入应用部署页面。
c. 上传 rar 适配器，并单击 “添加”，完成 rar 适配器的部署。
3. 创建连接池 testc
a. 在 TongWeb 控制台的左侧菜单栏中，选择 “EJB 容器” > “JCA 连接池”，进入 JCA 连接池页面。
b. 配置 JCA 连接池。
▪ 连接池名称：testc
▪ 连接定义：javax.jms.QueueConnectionFactory
![image](https://cdn-mineru.openxlab.org.cn/result/2026-02-12/74b543db-ed7f-4e00-9dd6-394d463bb982/3516983a208577b39a28cb3a8e9100f796a49a98bea08955a05ce7c22f04b4c4.jpg)
c. 配置其他属性。
![image](https://cdn-mineru.openxlab.org.cn/result/2026-02-12/74b543db-ed7f-4e00-9dd6-394d463bb982/8fa4fa113d150133f2b287639fbcfdd17b5afae448dafffd6d3fdb315d083a93.jpg)
d. 单击 “添加”，完成 JCA 连接池 testc 的创建。
4. 创建托管对象 testd
a. 在 TongWeb 控制台的左侧菜单栏中，选择 “EJB 容器” > “JCA 托管对象”，进入 JCA 托管对象页面。
b. 配置 JCA 托管对象。
▪ 托管对象名称：testd
▪ 资源类型：javax.jms.Queue
![image](https://cdn-mineru.openxlab.org.cn/result/2026-02-12/74b543db-ed7f-4e00-9dd6-394d463bb982/8db3659929f500580413993c35a8f96410cb8966767cf5e0cb81f6d890062a3c.jpg)
c. 配置其他属性。
![image](https://cdn-mineru.openxlab.org.cn/result/2026-02-12/74b543db-ed7f-4e00-9dd6-394d463bb982/c5df70a55162b1a0e8683144e3a1126b014ae78baa05913594e2869fe9d9b5c3.jpg)
d. 配置完成后，单击 “添加”，完成 JCA 托管对象 testd 的创建。
5. 部署并访问 TongWeb 自带用例 jmsExample
注：自带用例 jmsExample.war 位于 “${tongweb.home}/version*/examples” 目录中。
a. 在 TongWeb 控制台的左侧菜单栏中，选择 “应用管理” > “应用”，进入应用列表页面。
b. 单击 “部署”，进入应用部署页面。
c. 上传 jmsExample.war 应用，并单击 “添加”，完成 jmsExample.war 应用的部署。
2.0.0.1:8088/jmsExample/ 
点对点消息模式中的消息收发例子：
应用前缀/MessageSend
应用前缀/MessageReceive
说明：
通过上图中的两个链接，即可实现消息的收发测试。
![image](https://cdn-mineru.openxlab.org.cn/result/2026-02-12/74b543db-ed7f-4e00-9dd6-394d463bb982/57a28c246c9283274cc316b7eb3ad5bb63c97c449af3404212e1f3f8d974de48.jpg)"
